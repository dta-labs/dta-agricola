<!DOCTYPE html>
<html lang="es" ng-app="Administracion">

<head>
    <meta charset="UTF-8">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- <meta http-equiv="Content-Security-Policy" content="script-src 'none'"> -->
    <meta name="description" content='"DTA - Irrigation Control\" es la aplicacón de DTA-Agricola para el monitoreo y control inteligente y en tiempo real de sistemas de riego y bombeo.'>
    <meta name="author" content="DTA-Labs (Laboratorio de Desarrollos Tecnológicos Avanzados) https://dtaamerica.com/">
    <meta name="theme-color" content="#0000EF" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title>DTA - Irrigation Control v0.2b</title>

    <link rel="apple-touch-icon" href="./assets/images/DTA-Agricola.png">
    <link rel="apple-touch-icon" sizes="512x512" href="./assets/images/icons/res/DTA_Agricola_512.png">
    <link rel="apple-touch-icon" sizes="192x192" href="./assets/images/icons/res/mipmap-xxxhdpi/DTA_Agricola.png">
    <link rel="apple-touch-icon" sizes="144x144" href="./assets/images/icons/res/mipmap-xxhdpi/DTA_Agricola.png">
    <link rel="apple-touch-icon" sizes="96x96" href="./assets/images/icons/res/mipmap-xhdpi/DTA_Agricola.png">
    <link rel="apple-touch-icon" sizes="72x72" href="./assets/images/icons/res/mipmap-hdpi/DTA_Agricola.png">
    <link rel="apple-touch-icon" sizes="48x48" href="./assets/images/icons/res/mipmap-mdpi/DTA_Agricola.png">
    <link rel="apple-touch-startup-image" href="./assets/images/DTA-Agricola.png">
    <meta name="apple-mobile-web-app-title" content="DTA-Control v0.1b">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <link rel="icon" href="./assets/images/DTA-Agricola.png" />
    <link rel="manifest" href="manifest.json">
</head>

<body id="ControladorPrincipal" ng-controller="ControladorPrincipal" ng-init="inicializacion()">

    <!-- Inicio -->

    <div id="intro">
        <img src="./assets/images/intro.webp" class="show-in-pc-only" style="width: 100%; height: 100vh;" alt="intro">
        <img src="./assets/images/intro.webp" class="show-in-mobil-only" style="height: 100vh;" alt="intro">
        <div class="intro">
            <img src="./assets/images/DTA-Agricola lineal.png" style="width: 200px;" alt="iniciando">
            <h4 style="margin: 0; font-size: 1.5rem;">Iniciando...</h4>
        </div>
    </div>

    <!-- #region: Spinner -->

    <div id="spinner" class="spinner">
        <div style="width: 100%; text-align: center;">
            <div class="loader" style="margin: auto;"></div>
            <p>Esperando confirmación...</p>
        </div>
    </div>

    <!-- #endregion: Spinner -->

    <!-- #region: OFFLINE -->

    <section id="offline" style="display: none;">
        <div class="container valign-wrapper center-align" style="width: 95% !important; height: calc(100vh - 200px) !important;">
            <span>
                <img src="./assets/images/offline3.png" alt="offline" style="width: 70%">
            </span>
        </div>
    </section>

    <!-- #endregion: OFFLINE -->

    <div id="contenido" style="display: none;">

        <div class="row">

            <!-- #region: MENU PC -->

            <div class="col s0 m3 l2">
                <div class="left_col show-in-pc-only">
                    <div class="main-menu">

                        <div class="navbar nav_title" style="border: 0; border-bottom: 3px solid;">
                            <a href="index.html">
                                <img src="./assets/images/DTA-Agricola lineal white.png" class="img-logo"
                                    alt="DTA-Agricola">
                            </a>
                        </div>
                        <div class="clearfix"></div>

                        <!-- sidebar menu -->
                        <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">

                            <div class="nav-wrapper">
                                <ul class="side-menu">
                                    <li ng-click="showWindow('listado')" class="modal-trigger" ng-show="authUser">
                                        <a href="#">
                                            <i class="fa fa-th-list" aria-hidden="true"></i>
                                            &nbsp;&nbsp;Mis riegos
                                        </a>
                                    </li>
                                    <li ng-show="authUser" style="display: block;">
                                        <a href="#">
                                            <i class="fa fa-cogs" aria-hidden="true"></i>
                                            &nbsp;&nbsp;Servicios
                                        </a>
                                        <ul style="margin-left: 35px;">
                                            <li ng-click="loadCultures()" style="cursor: pointer;">
                                                <i class="fa fa-leaf" aria-hidden="true"></i>&nbsp;&nbsp;Fichas técnicas
                                            </li>
                                            <li ng-click="selectPlanRiego()" style="cursor: pointer;">
                                                <i class="fa fa-calendar" aria-hidden="true"></i>&nbsp;&nbsp;Planificar riego
                                            </li>
                                            <li id="installBtn" ng-click="automatizaciones()" style="cursor: pointer;">
                                                <i class="fa fa-magic" aria-hidden="true"></i>&nbsp;&nbsp;Automatizaciones
                                            </li>
                                        </ul>
                                    </li>
                                    <li ng-show="authUser">
                                        <a href="#">
                                            <i class="fa fa-sliders" aria-hidden="true"></i>
                                            &nbsp;&nbsp;Opciones
                                        </a>
                                        <ul style="margin-left: 35px;">
                                            <li ng-click="showWindow('users')" style="cursor: pointer;">
                                                <i class="fa fa-users" aria-hidden="true"></i>&nbsp;&nbsp;Perfil de usuario
                                            </li>
                                            <li ng-click="showWindow('notificaciones')" style="cursor: pointer;">
                                                <i class="fa fa-bell-o" aria-hidden="true"></i>&nbsp;&nbsp;Notificaciones
                                            </li>
                                            <li id="installBtn1" onclick="instalar()" style="cursor: pointer;">
                                                <i class="fa fa-check-square-o" aria-hidden="true"></i>&nbsp;&nbsp;Instalar la aplicación
                                            </li>
                                            <li ng-click="reload()" style="cursor: pointer;">
                                                <i class="fa fa-download" aria-hidden="true"></i>&nbsp;&nbsp;Actualizar el sistema
                                            </li>
                                        </ul>
                                    </li>
                                    <li ng-click="showWindow('login')" ng-show="!authUser">
                                        <a href="#" style="width: 100%;">
                                            <i class="fa fa-sign-in" aria-hidden="true"></i>
                                            &nbsp;&nbsp;Registro
                                        </a>
                                    </li>
                                    <li ng-click="showWindow('ayuda')">
                                        <a href="#!/ayuda" style="width: 100%;">
                                            <!-- <div> -->
                                                <i class="fa fa-question" aria-hidden="true"></i>
                                                &nbsp;&nbsp;Ayuda
                                            <!-- </div> -->
                                        </a>
                                    </li>
                                    <li ng-click="logout()" ng-show="authUser" ng-click="logout()">
                                        <a href="#!/login" style="width: 100%;">
                                            <i class="fa fa-sign-out" aria-hidden="true"></i>
                                            &nbsp;Salir
                                        </a>
                                    </li>
                                </ul>
                            </div>

                        </div>
                        <!-- /sidebar menu -->

                        <!-- /menu footer buttons -->
                        <div class="sidebar-footer hidden-small">
                            <a href="https://dtaamerica.com/dta-agricola" target="_blank" title="DTA-Agrícola" style="color: white;">
                                <img src="./assets/images/DTA-white.png" style="width: 55px;" alt="DTA-Agrícola">
                            </a>
                            <a href="https://wa.me/526251523176?text=DTA-Agr%C3%ADcola%20decide%20d%C3%B3nde,%20cu%C3%A1ndo%20y%20cu%C3%A1nto%20regar%20con%20un%20solo%20click.%20Especialmente%20dise%C3%B1ado%20para%20productores%20peque%C3%B1os,%20medianos%20y%20grandes%20que%20deseen%20producir%20m%C3%A1s%20con%20menor%20consumo%20de%20recursos" 
                                target="_blank" title="WhatsApp" style="display: none;">
                                <img src="./assets/images/whatsapp.png" altstyle="width: 55px;" style="width: 25px; border-radius: 4px;" alt="WhatsApp">
                            </a>
                            <a href="https://www.facebook.com/dtaagricola" target="_blank" title="Facebook" style="color: white;">
                                <i class="fa fa-facebook-square" aria-hidden="true"></i>
                            </a>
                            <a href="https://www.youtube.com/channel/UCTaEslx6PsGZ8F87EIfNywA" target="_blank" title="YouTube" style="color: white;">
                                <i class="fa fa-youtube-square" aria-hidden="true"></i>
                            </a>
                        </div>
                        <!-- /menu footer buttons -->
                    </div>
                </div>
            </div>
            
            <!-- #endregion: MENU PC -->
            
            <div class="col s12 m8 l10">

                <!-- #region: MENU CELULAR -->

                <header>

                    <!-- Barra menú inferior Celular -->
                    <div class="show-in-mobil-only row bottom-navbar" ng-show="authUser && selectedWindow == 'sistema'"
                        style="border-radius: 10px 10px 0 0;">
                        <div class="col navbar-option">
                            <a href="javascript:void(0)" ng-click="actualSystemWindows('as_config')" style="color: black;">
                                <i class="material-icons" style="margin-top: 5px;">slow_motion_video</i>
                                <p style="margin-top: -8px;">Planes</p>
                            </a>
                        </div>
                        <div class="col navbar-option">
                            <a href="javascript:void(0)" ng-click="actualSystemWindows('as_adjust')" style="color: black;">
                                <i class="fa fa-cog" aria-hidden="true" style="margin-top: 5px;"></i>
                                <p style="margin-top: -4px;">Ajustes</p>
                            </a>
                        </div>
                        <div class="col navbar-option">
                            <a href="javascript:void(0)" ng-click="actualSystemWindows('as_more')" style="color: black;">
                                <i class="fa fa-info-circle" aria-hidden="true" style="margin-top: 5px;"></i>
                                <p style="margin-top: -4px;">Generales</p>
                            </a>
                        </div>
                        <div class="col navbar-option">
                            <a href="javascript:void(0)" ng-click="actualSystemWindows('as_hist')" style="color: black;">
                                <i class="fa fa-history" aria-hidden="true" style="margin-top: 5px;"></i>
                                <p style="margin-top: -4px;">Históricos</p>
                            </a>
                        </div>
                        <div class="col navbar-option">
                            <a href="javascript:void(0)" ng-click="actualSystemWindows('as_users')" style="color: black;">
                                <i class="fa fa-users" aria-hidden="true" style="margin-top: 5px;"></i>
                                <p style="margin-top: -4px;">Usuarios</p>
                            </a>
                        </div>
                    </div>

                    <!-- Barra menú inferior PC -->
                    <div class="show-in-pc-only row bottom-navbar systemMenuPC" ng-show="authUser && selectedWindow == 'sistema'">
                        <div class="col navbar-option">
                            <a href="javascript:void(0)" ng-click="actualSystemWindows('as_config')" style="color: black;">
                                <i class="material-icons" style="margin-top: 5px;">slow_motion_video</i>
                                <p style="margin-top: -8px;">Planes</p>
                            </a>
                        </div>
                        <div class="col navbar-option">
                            <a href="javascript:void(0)" ng-click="actualSystemWindows('as_adjust')" style="color: black;">
                                <i class="fa fa-cog" aria-hidden="true" style="margin-top: 5px;"></i>
                                <p style="margin-top: -4px;">Ajustes</p>
                            </a>
                        </div>
                        <div class="col navbar-option">
                            <a href="javascript:void(0)" ng-click="actualSystemWindows('as_more')" style="color: black;">
                                <i class="fa fa-info-circle" aria-hidden="true" style="margin-top: 5px;"></i>
                                <p style="margin-top: -4px;">Generales</p>
                            </a>
                        </div>
                        <div class="col navbar-option">
                            <a href="javascript:void(0)" ng-click="actualSystemWindows('as_hist')" style="color: black;">
                                <i class="fa fa-history" aria-hidden="true" style="margin-top: 5px;"></i>
                                <p style="margin-top: -4px;">Históricos</p>
                            </a>
                        </div>
                        <div class="col navbar-option">
                            <a href="javascript:void(0)" ng-click="actualSystemWindows('as_users')" style="color: black;">
                                <i class="fa fa-users" aria-hidden="true" style="margin-top: 5px;"></i>
                                <p style="margin-top: -4px;">Usuarios</p>
                            </a>
                        </div>
                    </div>

                    <!-- Barra menú inferior Regresar -->
                    <!-- <div class="show-in-mobil-only row bottom-navbar"
                        ng-show="selectedWindow == 'mapas' || selectedWindow == 'estadisticas' || selectedWindow == 'notificaciones' || selectedWindow == 'ayuda' || selectedWindow == 'usuarios'"
                        ng-click="showWindow('servicios')" style="border-radius: 10px 10px 0 0;">
                        <div class="col s12 center-align" style="font-size: 1.3em; margin-top: 10px;">
                            <i class="fa fa-arrow-left" aria-hidden="true" style="margin-top: 5px;"></i>
                            <span style="margin-top: -4px;">Regresar</span>
                        </div>
                    </div> -->

                    <!-- Barra menú superior Celular -->
                    <div class="show-in-mobil-only top-navbar">
                        <div class="row">
                            <div class="col s2" style="margin-left: -15px;">
                                <img class="img-logo-cel" src="./assets/images/DTA.png" alt="DTA-Agricola">
                            </div>
                            <div class="col {{ authUser ? 's7' : 's8'}} center-align">
                                <p id="control_de_riego">Control de riego</p>
                            </div>
                            <div class="col s2 right-align">
                                <div ng-show="!authUser">
                                    <a href="#!/login" ng-click="showWindow('login')" style="color: black;">
                                        <i class="fa fa-user" aria-hidden="true" style="margin-top: 5px; font-size: 2em;"></i>
                                        <!-- <p style="margin-top: -5px;">Acceso</p> -->
                                    </a>
                                </div>
                                <div ng-show="authUser">
                                    <img id="imgAuthMobil" src="{{authUser.photoURL}}" class="img-auth"
                                        style="width: 32px; height: 32px; border-radius: 50%; margin-top: 2px;"
                                        ng-show="authUser.photoURL">
                                    <i class="fa fa-user" aria-hidden="true" style="margin-top: 5px; margin-bottom: 4px;"
                                        ng-show="!authUser.photoURL"></i>
                                    <!-- <p style="margin-top: -7px; color: black;">{{ authUser.displayName.split(" ")[0] }}</p> -->
                                </div>
                            </div>
                            <div class="col s1 right-align" ng-show="authUser">
                                <a href="#!servicios" ng-click="showWindow('servicios')" style="color: black;">
                                    <!-- <i class="material-icons" style="margin-top: 5px; margin-left: -15px;">menu</i> -->
                                    <i class="fa fa-ellipsis-v" aria-hidden="true" style="font-size: 2em; margin-top: 5px;"></i>
                                </a>
                            </div>
                            <!-- <h5 style="margin-top: 8px;" ng-show="selectedWindow == 'listado'">
                                <i class="fa fa-tasks" aria-hidden="true"></i>
                                Mis sistemas
                            </h5>
                            <h5 style="margin-top: 8px;" ng-show="selectedWindow == 'sistema'">
                                <i class="fa fa-sliders" aria-hidden="true"></i>
                                Configuración
                            </h5>
                            <h5 style="margin-top: 8px;" ng-show="selectedWindow == 'mapas'">
                                <i class="fa fa-map-marker" aria-hidden="true"></i>
                                Vista general
                            </h5>
                            <h5 style="margin-top: 8px;" ng-show="selectedWindow == 'servicios'">
                                <i class="fa fa-list-ul" aria-hidden="true"></i>
                                Opciones
                            </h5>
                            <h5 style="margin-top: 8px;" ng-show="selectedWindow == 'estadisticas'">
                                <i class="fa fa-bar-chart-o" aria-hidden="true"></i>
                                Estadisticas
                            </h5>
                            <h5 style="margin-top: 8px;" ng-show="selectedWindow == 'notificaciones'">
                                <i class="fa fa-bell-o" aria-hidden="true"></i>
                                Notificaciones
                            </h5>
                            <h5 style="margin-top: 8px;" ng-show="selectedWindow == 'ayuda'">
                                <i class="fa fa-question" aria-hidden="true"></i>
                                Ayuda
                            </h5>
                            <h5 style="margin-top: 8px;" ng-show="selectedWindow == 'login'">
                                <i class="fa fa-tasks" aria-hidden="true"></i>
                                Seguridad
                            </h5> -->
                        </div>

                        <!-- Ubicación actual -->

                        <!-- <div class="fixed-action-btn">
                            <a class="btn-floating white" ng-click="setMyPossition()">
                                <i class="fa fa-crosshairs black-text" aria-hidden="true"></i>
                            </a>
                        </div> -->
                    </div>

                </header>

                <!-- #endregion: MENU CELULAR -->

                <!-- #region: LISTADO -->

                <section id="listado" ng-show="selectedWindow == 'listado'">

                    <div class="container" style="width: 95% !important;">

                        <div class="show-in-mobil-only" style="margin-top: 55px !important;"></div>

                        <div class="show-in-pc-only" style="margin-top: 15px !important;"></div>

                        <div class="main-container text-center our-services">
                            <div class="row" style="margin-left: 0; margin-right: 0;">
                                <div class="col s12 m6 xl4" id="{{ system.key }}" ng-repeat="system in systems"
                                    ng-click="selectSystem(system)" ng-show="system.name">
                                    <div class="sercices-options waves-effect"
                                        style="background: {{ system.type == 'Estacionario' && system.log.state == 'ON' ? '#20b2aab0' : 
                                        system.log.state == 'OFF' ? '#d3d3d3e0' : system.log.voltage == 'false' ? '#ff0000c0' : 
                                        system.log.safety == 'false' ? '#db7093c0' : system.log.commDelay != '-1' ? '#808080e0' : '#20b2aab0' }};
                                        display: block !important;">
                                        <!-- <a href="#!/sistema" style="color: {{ system.log.state == 'OFF' ? 'grey' : 'white' }};"> -->
                                        <!-- <a ng-click="showWindow('sistema')" style="color: {{ system.log.state == 'OFF' ? 'grey' : 'white' }};"> -->
                                        <a href="#!/sistema" ng-click="showWindow('sistema')" style="color: {{ system.log.state == 'OFF' ? 'grey' : 'white' }};">
                                            <div class="row" style="margin-bottom: 0;">
                                                <div class="col s3" style="margin-top: 10px;">
                                                    <div class="pivote" ng-show="system.type != 'Estacionario'">
                                                        <div class="esfera" style="border-color: {{ system.log.state == 'OFF' ? 'grey' : 'white' }};">
                                                            <div id="pos_{{ system.key }}" class="brazo" style="border-color: {{ system.log.state == 'OFF' ? 'grey' : 'white' }};"></div>
                                                        </div>
                                                    </div>
                                                    <div ng-show="system.type == 'Estacionario'">
                                                        <img src="./assets/images/{{ system.log.state == 'OFF' ? 'parcela-grey' : 'parcela' }}.png" class="parcela_icon"
                                                            alt="parcela">
                                                    </div>
                                                </div>

                                                <div class="col s7 limitar" ng-show="system.type != 'Estacionario'">
                                                    <span style="font-size: 1.2em;">{{ system.name }}</span>
                                                    <br>
                                                    <i class="fa fa-undo" style="font-size: .8em;"
                                                        ng-show="system.direction == 'RR'"></i>
                                                    <i class="fa fa-repeat" style="font-size: .8em;"
                                                        ng-show="system.direction == 'FF'"></i>
                                                    <span style="font-size: .8em;">
                                                        <!-- <i class="material-icons" style="font-size: .9em;">near_me</i> -->
                                                        {{ system.log.position ? system.log.position : 0 }}°
                                                    </span>
                                                    <span style="font-size: .8em;">
                                                        <i class="material-icons" style="font-size: .9em;">network_check</i>
                                                        {{ system.log.speed ? system.log.speed : 0}}%
                                                    </span>
                                                    <span style="font-size: .8em;">
                                                        <i class="fa fa-tint" aria-hidden="true"></i>
                                                        {{ system.log.presion ? system.log.presion : 0 }}psi
                                                    </span>
                                                    <br>
                                                    <span ng-show="system.status == 'OFF' || !system.log" style="font-size: .8em;"><b>OFF</b></span>
                                                    <span style="font-size: .8em;">
                                                        [{{ ((system.log.voltage == 'true' && system.log.safety == 'true' && system.log.commDelay == '-1') || system.status == 'OFF') && system.log.update ? system.log.update : "00000000 0000" }}]
                                                    </span>
                                                    <span
                                                        ng-show="(system.log.voltage == 'false' || system.log.safety == 'false' || (system.log.commDelay != '-1' && system.log.voltage == 'true' && system.log.safety == 'true')) && system.status == 'ON'"
                                                        style="font-size: .8em;">
                                                        <b><i>
                                                                <span>{{ system.log.voltage == 'false' ? 'Falla de
                                                                    electricidad!' :
                                                                    system.log.safety == 'false' ? '¡Alarma: falla de seguridad!' :
                                                                    system.log.commDelay != '-1' ? '¡Falla de comunicación!' : ''
                                                                    }}</span>
                                                                <span
                                                                    ng-show="system.log.voltage == 'false' || system.log.safety == 'false'">{{
                                                                    system.log.statusTime }}</span>
                                                                <span
                                                                    ng-show="system.log.commDelay != '-1' && system.log.voltage == 'true' && system.log.safety == 'true'">
                                                                    {{ system.log.commDelay }}
                                                                </span>
                                                            </i></b>
                                                    </span>
                                                    <span
                                                        ng-show="system.log.voltage == 'false' || system.log.safety == 'false'"
                                                        style="font-size: .8em;"><span
                                                            id="errorTime_{{ system.key }}"></span></span>
                                                </div>
                                                
                                                <div class="col s7 limitar" ng-show="system.type == 'Estacionario'">
                                                    <span style="font-size: 1.2em;">{{ system.name }}</span>
                                                    <br>
                                                    <span style="font-size: .8em;">
                                                        <i class="material-icons" style="font-size: 1.2em;">alarm</i>
                                                        {{ system.log && system.log.timer  ? system.log.timer : "00:00:00" }}
                                                    </span>
                                                    <span style="font-size: .8em;">
                                                        <i class="material-icons" style="font-size: 1.2em;">map</i>
                                                        {{ system.log && system.log.plot ? system.log.plot : 0}}
                                                    </span>
                                                    <span style="font-size: .8em;">
                                                        <i class="fa fa-tint" aria-hidden="true"></i>
                                                        {{ system.log.presion ? system.log.presion : 0 }}psi
                                                    </span>
                                                    <br>
                                                    <span style="font-size: .8em;"><b>{{ system.status }}</b></span>
                                                    <span style="font-size: .8em;">[{{ system.log.update ? system.log.update : "00000000 0000" }}]</span>
                                                </div>

                                                <div class="col s2" style="margin: 2px 0 0 -10px; text-align: right;">
                                                    <img src="{{ meteo[system.key].weather.iconUrl }}" alt="Weather icon" ng-if="meteo[system.key].weather.iconUrl">
                                                </div>           
                                            </div>
                                        </a>
                                    </div>
                                </div>
                                <div class="col s12" ng-show="authUser">
                                    <div class="col s12 sercices-options waves-effect white-text teal lighten-3 center-align modal-trigger"
                                        style="width: 100%; padding: 10px 0; background: #80cbc4f0 !important;">
                                        <a class="modal-trigger" href="#modalNuevoEquipo" style="color: white !important;"
                                            ng-click="createNewDevice()">
                                            <div class="row" style="margin-bottom: 0;">
                                                <div class="col s12">
                                                    <i class="material-icons" style="font-size: 2.5em;">add</i><br>
                                                    <span style="font-size: 1.3em;">Agregar equipo</span>
                                                </div>
                                            </div>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <br>
                    </div>

                    <!-- Modal Nuevo Equipo -->
                    <div id="modalNuevoEquipo" class="modal">
                        <div class="modal-header">
                            Agregar equipo
                        </div>
                        <div class="modal-content">
                            <div class="row" style="margin-top: 35px;">
                                <div class="input-field col s12">
                                    <input id="newDeviceName" type="text" placeholder="Nombre del equipo"
                                        ng-model="newDevice.name">
                                    <label for="newDeviceName">Nombre del equipo (alias)</label>
                                </div>
                                <div class="input-field col s12">
                                    <input id="newDeviceKey" type="text" placeholder="Código del equipo"
                                        ng-model="newDevice.key">
                                    <label for="newDeviceKey">Código identificador del equipo</label>
                                </div>
                                <div class="input-field col s12">
                                    <select class="select" ng-model="newDevice.type" ng-change="setNewDeviceParams()">
                                        <option value="" disabled selected>Seleccione un tipo</option>
                                        <option value="PC" data-icon="./assets/images/riegoPivote.png">Pivote central</option>
                                        <option value="PL" data-icon="./assets/images/riegoPivote.png">Pivote lineal</option>
                                        <option value="Estacionario" data-icon="./assets/images/riegoGoteo.png">Estacionario</option>
                                        <option value="Pozo" data-icon="./assets/images/riegoPozo.png">Bombeo</option>
                                    </select>
                                    <label for="newDeviceType">Tipo de equipo</label>
                                </div>
                                <div class="input-field col s12" ng-show="newDevice.type == 'PC' || newDevice.type == 'PL'">
                                    <select class="select" ng-model="newDevice.brand">
                                        <option value="valley">Valley | Valley cams</option>
                                        <option value="growsmart">Zimmatic | Rintec hydrus | Growsmart</option>
                                        <option value="lindsay">Lindsay</option>
                                    </select>
                                    <label>Compatibilidad</label>
                                </div>
                                <div class="col s12"
                                    style="background: whitesmoke; box-shadow: 0 0 3px lightgrey; margin-bottom: 20px;">
                                    <label>Geolocalización</label>
                                    <div class="row">
                                        <div class="input-field col s6">
                                            <input id="newDeviceLatitude" type="text" placeholder="Latidud"
                                                ng-model="newDevice.latitude">
                                            <label for="newDeviceLatitude">Latitud</label>
                                        </div>
                                        <div class="input-field col s6">
                                            <input id="newDeviceLongitude" type="text" placeholder="Longitud"
                                                ng-model="newDevice.longitude">
                                            <label for="newDeviceLongitude">Longitud</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="input-field col s6" ng-show="newDevice.type == 'PC' || newDevice.type == 'PL'">
                                    <input id="newDeviceLarge" type="number" placeholder="Largo del equipo"
                                        ng-model="newDevice.length">
                                    <label for="newDeviceLarge">Largo del equipo</label>
                                </div>
                                <div class="input-field col s6" ng-show="newDevice.type == 'PC' || newDevice.type == 'PL'">
                                    <input id="newDeviceMaxVelocity" type="number" placeholder="Límite de velocidad"
                                        ng-model="newDevice.maxVelocity">
                                    <label for="newDeviceLarge">Límite de velocidad</label>
                                </div>
                                <div class="input-field col s6"
                                    ng-show="newDevice.type != 'PC' && newDevice.type != 'PL' && newDevice.type != 'PL'">
                                    <select class="select" ng-model="newDevice.length">
                                        <option value="4">J0004 (3 válvulas + pozo)</option>
                                        <option value="8">J0008 (7 válvulas + pozo)</option>
                                    </select>
                                    <label for="newDeviceLarge">Serie</label>
                                </div>
                                <div class="input-field col s6" ng-init="newDevice.zona = '0'">
                                    <!-- <input id="newDeviceZona" type="number" placeholder="Zona" ng-model="newDevice.zona"> -->
                                    <select ng-model="newDevice.zona" style="display: block !important;">
                                        <option ng-selected="newDevice.zona == -11 ? true : false" value="-11">UTC-11 Pacific
                                        </option>
                                        <option ng-selected="newDevice.zona == -10 ? true : false" value="-10">UTC-10
                                            America-Pacific</option>
                                        <option ng-selected="newDevice.zona == -9 ? true : false" value="-9:30">UTC-9:30 Pacific
                                        </option>
                                        <option ng-selected="newDevice.zona == -9 ? true : false" value="-9">UTC-9
                                            America-Pacific</option>
                                        <option ng-selected="newDevice.zona == -8 ? true : false" value="-8">UTC-8
                                            America-Pacific</option>
                                        <option ng-selected="newDevice.zona == -7 ? true : false" value="-7">UTC-7 America
                                        </option>
                                        <option ng-selected="newDevice.zona == -6 ? true : false" value="-6">UTC-6
                                            America-Pacific</option>
                                        <option ng-selected="newDevice.zona == -5 ? true : false" value="-5">UTC-5 America
                                        </option>
                                        <option ng-selected="newDevice.zona == -4 ? true : false" value="-4">UTC-4
                                            America-Atlantic</option>
                                        <option ng-selected="newDevice.zona == -3 ? true : false" value="-3">UTC-3
                                            America-Atlantic</option>
                                        <option ng-selected="newDevice.zona == -2 ? true : false" value="-2">UTC-2
                                            America-Atlantic</option>
                                        <option ng-selected="newDevice.zona == -1 ? true : false" value="-1">UTC-1
                                            America-Atlantic</option>
                                        <option ng-selected="newDevice.zona == +0 ? true : false" value="+0">UTC+0
                                            Africa-America-Atlantic-Europe</option>
                                        <option ng-selected="newDevice.zona == +1 ? true : false" value="+1">UTC+1
                                            Africa-Arctic-Europe</option>
                                        <option ng-selected="newDevice.zona == +2 ? true : false" value="+2">UTC+2 Africa-Europe
                                        </option>
                                        <option ng-selected="newDevice.zona == +3 ? true : false" value="+3">UTC+3
                                            Africa-Asia-Europe-Indian</option>
                                        <option ng-selected="newDevice.zona == +4 ? true : false" value="+4">UTC+4
                                            Asia-Europe-Indian</option>
                                        <option ng-selected="newDevice.zona == +5 ? true : false" value="+5">UTC+5
                                            Antarctica-Asia-Indian</option>
                                        <option ng-selected="newDevice.zona == +6 ? true : false" value="+6">UTC+6
                                            Antarctica-Asia-Indian</option>
                                        <option ng-selected="newDevice.zona == +7 ? true : false" value="+7">UTC+7
                                            Antarctica-Asia-Indian</option>
                                        <option ng-selected="newDevice.zona == +8 ? true : false" value="+8">UTC+8
                                            Asia-Australia </option>
                                        <option ng-selected="newDevice.zona == +9 ? true : false" value="+9">UTC+9 Asia-Pacific
                                        </option>
                                        <option ng-selected="newDevice.zona == +10 ? true : false" value="+10">UTC+10
                                            Antarctica-Asia-Australia </option>
                                        <option ng-selected="newDevice.zona == +10 ? true : false" value="+10">UTC+10:30
                                            Australia </option>
                                        <option ng-selected="newDevice.zona == +11 ? true : false" value="+11">UTC+11
                                            Antarctica-Asia </option>
                                        <option ng-selected="newDevice.zona == +12 ? true : false" value="+12">UTC+12
                                            Antarctica-Asia </option>
                                        <option ng-selected="newDevice.zona == +13 ? true : false" value="+13">UTC+13 Pacific
                                        </option>
                                        <option ng-selected="newDevice.zona == +14 ? true : false" value="+14">UTC+14 Pacific
                                        </option>
                                    </select>
                                    <!-- <label for="newDeviceZona">Zona</label> -->
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <a href="#!" class="modal-close waves-effect waves-green btn-flat">Cancelar</a>
                            <a href="#!" class="waves-effect waves-green btn-flat" ng-click="updateNewDevice()">Agregar</a>
                        </div>
                    </div>

                </section>

                <!-- #endregion: LISTADO -->

                <!-- #region: SISTEMA -->

                <section id="sistema" ng-show="selectedWindow == 'sistema'">

                    <div class="container" style="width: 95% !important;">

                        <div class="show-in-mobil-only" style="margin-top: 35px !important;"></div>

                        <div class="show-in-pc-only" style="margin-top: 15px !important;"></div>
                        
                        <div class="main-container text-center our-services">

                            <div class="switchControl waves-effect input-field" ng-click="showWindow('listado')"
                                style="background: {{ actualSystem.type == 'Estacionario' && actualSystem.log.state == 'ON' ? '#20b2aab0' : 
                                        actualSystem.log.state == 'OFF' ? '#d3d3d3e0' : actualSystem.log.voltage == 'false' ? '#ff0000c0' : 
                                        actualSystem.log.safety == 'false' ? '#db7093c0' : actualSystem.log.commDelay != '-1' ? '#808080e0' : '#20b2aab0' }}; 
                                        cursor: pointer; display: block !important;">
                                <div class="row" style="margin-bottom: 0;">
                                    <div class="col s2 m2" style="margin: 2px 0 0 10px; cursor: pointer;">
                                        <i class="material-icons" style="font-size: 3.5em; margin-left: -10px;">chevron_left</i>
                                    </div>
                                    <div class="col s7 m6">
                                        <div class="limitar" style="font-size: 1.5em;">
                                            <b>{{ systems[actualSystem.key].name }}</b>
                                        </div>
                                        <span>{{ systems[actualSystem.key].log.update }}</span>
                                    </div>
                                    <div class="col s2 m3" style="margin: 2px 0 0 -10px; text-align: center;">
                                        <p style="margin: 0; margin-top: -10px;"><img src="{{ meteo[actualSystem.key].weather.iconUrl }}" alt="Weather icon" ng-if="meteo[actualSystem.key].weather.iconUrl"></p>
                                        <p class="show-in-pc-only" style="margin: 0; margin-top: -15px;"><b>
                                            {{ meteo[actualSystem.key].main.temp - 273.15 | number : 0}}°C | {{ meteo[actualSystem.key].main.humidity }}% Hr
                                        </b></p>
                                        <p class="show-in-mobil-only" style="margin: 0; margin-top: -15px; width: 70px;"><b>
                                            {{ meteo[actualSystem.key].main.humidity }}% Hr
                                        </b></p>
                                    </div>
                                </div>
                            </div>

                            <div class="switchControl input-field"
                                style="background: rgba(255,255,255,.9); min-height: calc(100vh - 220px);">
                                <div class="row hide-on-med-and-up" style="margin-bottom: 0px;">
                                    <!-- <div class="switch switch2 col s4 switchLabel" style="margin-top: -5px;">Encendido</div> -->
                                    <div class="col s5 m12 row center-align bordered"
                                        ng-show="actualSystem.type != 'Estacionario'">
                                        <div id="direccion" class="col s12 m6" style="font-size: 1em;">
                                            Dirección
                                        </div>
                                        <div class="col s12 m6 switch switch" style="padding: 0px; margin-bottom: 10px;">
                                            <label>
                                                <span class="switchLabel"><i class="fa fa-undo" aria-hidden="true"
                                                        style="font-size: 1.5em !important;"></i></span>
                                                <input type="checkbox" ng-model="actualSystem.direction"
                                                    ng-checked="actualSystem.direction" ng-change="setMachineSettings()">
                                                <span class="lever"></span>
                                                <span class="switchLabel"><i class="fa fa-repeat" aria-hidden="true"
                                                        style="font-size: 1.5em !important;"></i></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col s6 m12 {{ actualSystem.type == 'Estacionario' ? 'offset-s5' : ''}}">
                                        <div class="row center-align bordered">
                                            <div id="encendido" class="col s12 m6" style="font-size: 1em; margin-bottom: 5px;">
                                                Encendido
                                            </div>
                                            <div class="col s12 m6 switch switch" style="padding: 0px; margin-bottom: 10px;">
                                                <label>
                                                    <span class="blackBg"><b>Off</b></span>
                                                    <input type="checkbox" ng-model="actualSystem.status"
                                                        ng-checked="actualSystem.status" ng-change="setMachineState()">
                                                    <span class="lever"></span>
                                                    <span class="redBg"><b>&nbsp;On&nbsp;</b></span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row" style="margin-bottom: 0px; width: 100%; margin: auto;">
                                    <div class="main-container map col s12 m8">
                                        <div id="map" class="map" style="border-radius: 5px;"></div>
                                    </div>
                                    <div class="input-field col s12 m4" style="margin-bottom: 0; margin-top: 0;">
                                        <div class="row">
                                            <div class="row hide-on-small-only" style="margin-bottom: 0px;">
                                                <!-- <div class="switch switch2 col s4 switchLabel" style="margin-top: -5px;">Encendido</div> -->
                                                <div class="col m11">
                                                    <div class="row center-align bordered" style="margin-left: 5px !important;">
                                                        <div id="encendido" class="col s12"
                                                            style="font-size: 1em; margin-bottom: 5px;">Encendido</div>
                                                        <div class="col s12 switch"
                                                            style="padding: 0px; margin-bottom: 10px;">
                                                            <label>
                                                                <span class="blackBg"><b>Off</b></span>
                                                                <input type="checkbox" ng-model="actualSystem.status"
                                                                    ng-checked="actualSystem.status"
                                                                    ng-change="setMachineState()">
                                                                <span class="lever"></span>
                                                                <span class="redBg"><b>&nbsp;On&nbsp;</b></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col m11" ng-show="actualSystem.type != 'Estacionario'">
                                                    <div class="row center-align bordered" style="margin-left: 5px !important;">
                                                        <div id="direccion" class="col s12" style="font-size: 1em;">Dirección
                                                        </div>
                                                        <div class="col s12 switch"
                                                            style="padding: 0px; margin-bottom: 10px;">
                                                            <label>
                                                                <span class="switchLabel"><i class="fa fa-undo"
                                                                        aria-hidden="true"
                                                                        style="font-size: 1.5em !important;"></i></span>
                                                                <input type="checkbox" ng-model="actualSystem.direction"
                                                                    ng-checked="actualSystem.direction"
                                                                    ng-change="setMachineSettings()">
                                                                <span class="lever"></span>
                                                                <span class="switchLabel"><i class="fa fa-repeat"
                                                                        aria-hidden="true"
                                                                        style="font-size: 1.5em !important;"></i></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="row" style="margin-bottom: 0;"
                                                ng-show="actualSystem.type == 'PC' || actualSystem.type == 'PL'">
                                                <div class="bordered col s4 m10 row"
                                                    style="border-bottom: 1px solid grey; margin-bottom: 15px; margin-right: -5px;">
                                                    <div class="col s12 m2 center-align">
                                                        <i class="material-icons" style="margin-top: 3px; color: {{ (actualSystem.log.safety == 'true') ? 'green' : 'red' }};">
                                                            {{ (actualSystem.log.safety == "true") ? 'check_circle' : 'do_not_disturb_alt' }}
                                                        </i>
                                                    </div>
                                                    <div class="col s12 m10 center-align">
                                                        <b>Seguridad</b>
                                                    </div>
                                                </div>
                                                <div class="bordered col s3 m10 row"
                                                    style="border-bottom: 1px solid grey; margin-bottom: 15px; margin-right: -5px;">
                                                    <div class="col s12 m2 center-align">
                                                        <i class="material-icons" style="margin-top: 3px; color: {{ (actualSystem.log.reception == 'Ok' && actualSystem.log.commDelay == '-1') ? 'green' : 'red' }};">
                                                            {{ (actualSystem.log.reception == 'Ok' && actualSystem.log.commDelay == '-1') ? 'check_circle' : 'do_not_disturb_alt' }}
                                                        </i>
                                                    </div>
                                                    <div class="col s12 m10 center-align">
                                                        <b>GSM</b>
                                                    </div>
                                                </div>
                                                <div class="bordered col s3 m10 row"
                                                    style="border-bottom: 1px solid grey; margin-bottom: 15px;">
                                                    <div class="col s12 m2 center-align">
                                                        <i class="material-icons" style="margin-top: 3px; color: {{ (actualSystem.log.latitude != '0.00000' && actualSystem.log.longitude != '0.00000') ? 'green' : 'red' }};">
                                                            {{ (actualSystem.log.latitude != '0.00000' && actualSystem.log.longitude != '0.00000') ? 'check_circle' : 'do_not_disturb_alt' }}
                                                        </i>
                                                    </div>
                                                    <div class="col s12 m10 center-align">
                                                        <b>GPS</b>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row" style="margin-bottom: 0;" 
                                            ng-show="actualSystem.type == 'Estacionario'">
                                            <div class="row">
                                                <div class="bordered col s4 m10 row" ng-click="as_config = !as_config"
                                                    style="border-bottom: 1px solid grey; margin-bottom: 15px;">
                                                    <div class="col s12 m2 center-align"><i class="material-icons">alarm</i></div>
                                                    <div class="col s12 m10 center-align">
                                                        <b>{{ actualSystem.log.activationTime ?
                                                            msToTime(actualSystem.log.activationTime) : 0 }}</b>
                                                    </div>
                                                </div>
                                                <div class="bordered col s2 m10 row"
                                                    style="border-bottom: 1px solid grey; margin-bottom: 15px;">
                                                    <div class="col s12 m2 center-align"><i class="material-icons">map</i></div>
                                                    <div class="col s12 m10 center-align">
                                                        <b>{{ actualSystem.log.plot ? strToInt(actualSystem.log.plot) + 1 : '0' }}</b>
                                                    </div>
                                                </div>
                                                <div class="bordered col s2 m10 row"
                                                    style="border-bottom: 1px solid grey; margin-bottom: 15px;">
                                                    <div class="col s12 m2 center-align"><i class="fa fa-tint" aria-hidden="true"
                                                            style="font-size: 1.7em; margin: 2px 0 3px 0;"></i></div>
                                                    <div class="col s12 m10 center-align">
                                                        <b>{{ actualSystem.log.presion ? actualSystem.log.presion : 0 }}</b>psi
                                                        <!-- <b>{{ actualSystem.log.presion ? actualSystem.log.presion * actualSystem.sensorPresion / 1024 : 0 }}</b>psi -->
                                                    </div>
                                                </div>
                                                <div class="bordered col s2 m10 row"
                                                    style="border-bottom: 1px solid grey; margin-bottom: 15px;">
                                                    <div class="col s12 m2 center-align"><i class="material-icons">rss_feed</i>
                                                    </div>
                                                    <div class="col s12 m10 center-align">
                                                        <b>{{ actualSystem.log.signal ? actualSystem.log.signal : 0 }}</b>/30
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row" style="margin-bottom: 0;" ng-show="actualSystem.type == 'PC' || actualSystem.type == 'PL'">
                                            <div class="row">
                                                <div class="bordered col s2 m10 row" ng-click="actualSystemWindows('as_config')"
                                                    style="border-bottom: 1px solid grey; margin-bottom: 15px; cursor: pointer;">
                                                    <div class="col s12 m2 center-align"><i class="material-icons">network_check</i>
                                                    </div>
                                                    <div class="col s12 m10 center-align">
                                                        <b>{{ actualSystem.log.speed ? actualSystem.log.speed : 0 }}</b>%
                                                    </div>
                                                </div>
                                                <div class="bordered col s2 m10 row"
                                                    style="border-bottom: 1px solid grey; margin-bottom: 15px; margin-bottom: 10px;">
                                                    <div class="col s12 m2 center-align"><i class="material-icons">near_me</i></div>
                                                    <div class="col s12 m10 center-align">
                                                        <b>{{ actualSystem.log.position ? actualSystem.log.position : 0 }}</b>°
                                                    </div>
                                                </div>
                                                <div class="bordered col s2 m10 row"
                                                    style="border-bottom: 1px solid grey; margin-bottom: 15px;">
                                                    <div class="col s12 m2 center-align"><i class="material-icons">search</i></div>
                                                    <div class="col s12 m10 center-align">
                                                        <b>{{ actualSystem.log.error ? actualSystem.log.error : 0 }}</b>cm
                                                    </div>
                                                </div>
                                                <div class="bordered col s2 m10 row"
                                                    style="border-bottom: 1px solid grey; margin-bottom: 15px;">
                                                    <div class="col s12 m2 center-align"><i class="fa fa-tint" aria-hidden="true"
                                                            style="font-size: 1.7em; margin: 2px 0 3px 0;"></i></div>
                                                    <div class="col s12 m10 center-align">
                                                        <b>{{ actualSystem.log.presion ? actualSystem.log.presion : 0 }}</b>psi
                                                        <!-- <b>{{ actualSystem.log.presion ? actualSystem.log.presion * actualSystem.sensorPresion / 1024 : 0 }}</b>psi -->
                                                    </div>
                                                </div>
                                                <div class="bordered col s2 m10 row"
                                                    style="border-bottom: 1px solid grey; margin-bottom: 15px;">
                                                    <div class="col s12 m2 center-align"><i class="material-icons">rss_feed</i>
                                                    </div>
                                                    <div class="col s12 m10 center-align">
                                                        <b>{{ actualSystem.log.signal ? actualSystem.log.signal : 0 }}</b>/30
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <br class="show-in-pc-only">
                                <div class="row" style="padding: 0 10px;" 
                                    ng-show="(actualSystem.type == 'PC' || actualSystem.type == 'PL') && as_config">
                                    <div class="col s12">
                                        <div class="btn" ng-click="as_config = !as_config" style="width: 100%;">
                                            <span style="position: absolute; left: 20px; font-size: 2em;">
                                                <i class="material-icons">slow_motion_video</i>
                                            </span>
                                            <span>
                                                Programación del riego
                                            </span>
                                            <span style="position: absolute; right: 20px;">
                                                <i class="fa fa-chevron-down" aria-hidden="true" ng-show="!as_config"></i>
                                                <i class="fa fa-chevron-up" aria-hidden="true" ng-show="as_config"></i>
                                            </span>
                                        </div>
                                        <div ng-show="as_config">
                                            <table class="striped highlight">
                                                <thead>
                                                    <tr>
                                                        <th>#</th>
                                                        <th><span class="angle">A</span> Inicial</th>
                                                        <th><span class="angle">A</span> Final</th>
                                                        <th>Pistola</th>
                                                        <th>Vel/Vol</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr ng-repeat="plan in actualSystemPlans" ng-show="plan"
                                                        class="modal-trigger" href="#modalEditRiego"
                                                        ng-click="setEditPlan($index)" style="cursor: pointer;">
                                                        <td><i class='fa fa-clock-o' aria-hidden='true'></i></td>
                                                        <td>{{ plan.starAngle }}</td>
                                                        <td>{{ plan.endAngle }}</td>
                                                        <td>{{ plan.endGun == 'true' ? 'Sí' : 'No'}}
                                                        <td>{{ plan.value }} %</td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="5" class="right-align">
                                                            <div class="btn waves-effect waves-light red lighten-3 modal-trigger"
                                                                href="#modalResetRiego" ng-show="actualSystem.plansLength > 1">
                                                                &nbsp;&nbsp;&nbsp;
                                                                <i class="material-icons">delete</i>
                                                                &nbsp;&nbsp;&nbsp;
                                                            </div>
                                                            <div class="btn waves-effect waves-light teal lighten-3 modal-trigger"
                                                                href="#modalRiego" ng-click="resetNewPlan()">
                                                                &nbsp;&nbsp;&nbsp;
                                                                <i class="material-icons">add</i>
                                                                &nbsp;&nbsp;&nbsp;
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr style="display: none;">
                                                        <td colspan="5" class="right-align">
                                                            <div class="switch">
                                                                Autoreverse
                                                                <label>
                                                                    <span class="blackBg"><b>Off</b></span>
                                                                    <input type="checkbox" ng-model="actualSystem.autoreverse"
                                                                        ng-checked="actualSystem.autoreverse"
                                                                        ng-change="setMachineSettings()">
                                                                    <span class="lever"></span>
                                                                    <span class="redBg"><b>&nbsp;On&nbsp;</b></span>
                                                                </label>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="row" style="padding: 0 10px;" ng-show="actualSystem.type == 'Estacionario' && as_config">
                                    <div class="col s12">
                                        <div style="margin-top: 20px;" ng-show="actualSystem.type == 'Estacionario' && as_config"></div>
                                        <div class="btn" ng-click="as_config = !as_config" style="width: 100%;">
                                            <span style="position: absolute; left: 20px; font-size: 2em;">
                                                <i class="material-icons">slow_motion_video</i>
                                            </span>
                                            <span>
                                                Programación del riego
                                            </span>
                                            <span style="position: absolute; right: 20px;">
                                                <i class="fa fa-chevron-down" aria-hidden="true" ng-show="!as_config"></i>
                                                <i class="fa fa-chevron-up" aria-hidden="true" ng-show="as_config"></i>
                                            </span>
                                        </div>
                                        <div ng-show="as_config">
                                            <table class="striped highlight">
                                                <thead>
                                                    <tr>
                                                        <th width="5%">#</th>
                                                        <th width="15%">Polígono</th>
                                                        <th width="20%">Días</th>
                                                        <th width="20%">Horas</th>
                                                        <th width="20%">Min</th>
                                                        <th width="20%">Válvula</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="modal-trigger" href="#modalEditRiegoEstacionario"
                                                        ng-click="setEditPlanEstacionario('p0')">
                                                        <td width="5%">1</td>
                                                        <td width="15%">
                                                            <i class="material-icons">
                                                                {{ actualSystem.plots.p0.poligon ? "map" : "location_off" }}
                                                            </i>
                                                        </td>
                                                        <td width="20%">{{ getDayFromMs(actualSystem.plots.p0.value) }}</td>
                                                        <td width="20%">{{ getHourFromMs(actualSystem.plots.p0.value) }}
                                                        <td width="20%">{{ getMinutesFromMs(actualSystem.plots.p0.value) }}</td>
                                                        <td width="20%">{{ actualSystem.plots.p0.valvle == "F" ? "Fijo" : "Pulso" }}</td>
                                                    </tr>
                                                    <tr class="modal-trigger" href="#modalEditRiegoEstacionario"
                                                        ng-click="setEditPlanEstacionario('p1')">
                                                        <td width="5%">2</td>
                                                        <td width="15%">
                                                            <i class="material-icons">
                                                                {{ actualSystem.plots.p1.poligon ? "map" : "location_off" }}
                                                            </i>
                                                        </td>
                                                        <td width="20%">{{ getDayFromMs(actualSystem.plots.p1.value) }}</td>
                                                        <td width="20%">{{ getHourFromMs(actualSystem.plots.p1.value) }}
                                                        <td width="20%">{{ getMinutesFromMs(actualSystem.plots.p1.value) }}</td>
                                                        <td width="20%">{{ actualSystem.plots.p1.valvle == "F" ? "Fijo" : "Pulso" }}</td>
                                                    </tr>
                                                    <tr class="modal-trigger" href="#modalEditRiegoEstacionario"
                                                        ng-click="setEditPlanEstacionario('p2')">
                                                        <td width="5%">3</td>
                                                        <td width="15%">
                                                            <i class="material-icons">
                                                                {{ actualSystem.plots.p2.poligon ? "map" : "location_off" }}
                                                            </i>
                                                        </td>
                                                        <td width="20%">{{ getDayFromMs(actualSystem.plots.p2.value) }}</td>
                                                        <td width="20%">{{ getHourFromMs(actualSystem.plots.p2.value) }}
                                                        <td width="20%">{{ getMinutesFromMs(actualSystem.plots.p2.value) }}</td>
                                                        <td width="20%">{{ actualSystem.plots.p2.valvle == "F" ? "Fijo" : "Pulso" }}</td>
                                                    </tr>
                                                    <tr class="modal-trigger" href="#modalEditRiegoEstacionario"
                                                        ng-if="actualSystem.length >= '4'"
                                                        ng-click="setEditPlanEstacionario('p3')">
                                                        <td width="5%">4</td>
                                                        <td width="15%">
                                                            <i class="material-icons">
                                                                {{ actualSystem.plots.p3.poligon ? "map" : "location_off" }}
                                                            </i>
                                                        </td>
                                                        <td width="20%">{{ getDayFromMs(actualSystem.plots.p3.value) }}</td>
                                                        <td width="20%">{{ getHourFromMs(actualSystem.plots.p3.value) }}
                                                        <td width="20%">{{ getMinutesFromMs(actualSystem.plots.p3.value) }}</td>
                                                        <td width="20%">{{ actualSystem.plots.p3.valvle == "F" ? "Fijo" : "Pulso" }}</td>
                                                    </tr>
                                                    <tr class="modal-trigger" href="#modalEditRiegoEstacionario"
                                                        ng-if="actualSystem.length >= '5'"
                                                        ng-click="setEditPlanEstacionario('p4')">
                                                        <td width="5%">5</td>
                                                        <td width="15%">
                                                            <i class="material-icons">
                                                                {{ actualSystem.plots.p4.poligon ? "map" : "location_off" }}
                                                            </i>
                                                        </td>
                                                        <td width="20%">{{ getDayFromMs(actualSystem.plots.p4.value) }}</td>
                                                        <td width="20%">{{ getHourFromMs(actualSystem.plots.p4.value) }}
                                                        <td width="20%">{{ getMinutesFromMs(actualSystem.plots.p4.value) }}</td>
                                                        <td width="20%">{{ actualSystem.plots.p4.valvle == "F" ? "Fijo" : "Pulso" }}</td>
                                                    </tr>
                                                    <tr class="modal-trigger" href="#modalEditRiegoEstacionario"
                                                        ng-if="actualSystem.length >= '6'"
                                                        ng-click="setEditPlanEstacionario('p5')">
                                                        <td width="5%">6</td>
                                                        <td width="15%">
                                                            <i class="material-icons">
                                                                {{ actualSystem.plots.p5.poligon ? "map" : "location_off" }}
                                                            </i>
                                                        </td>
                                                        <td width="20%">{{ getDayFromMs(actualSystem.plots.p5.value) }}</td>
                                                        <td width="20%">{{ getHourFromMs(actualSystem.plots.p5.value) }}
                                                        <td width="20%">{{ getMinutesFromMs(actualSystem.plots.p5.value) }}</td>
                                                        <td width="20%">{{ actualSystem.plots.p5.valvle == "F" ? "Fijo" : "Pulso" }}</td>
                                                    </tr>
                                                    <tr class="modal-trigger" href="#modalEditRiegoEstacionario"
                                                        ng-if="actualSystem.length >= '7'"
                                                        ng-click="setEditPlanEstacionario('p6')">
                                                        <td width="5%">7</td>
                                                        <td width="15%">
                                                            <i class="material-icons">
                                                                {{ actualSystem.plots.p6.poligon ? "map" : "location_off" }}
                                                            </i>
                                                        </td>
                                                        <td width="20%">{{ getDayFromMs(actualSystem.plots.p6.value) }}</td>
                                                        <td width="20%">{{ getHourFromMs(actualSystem.plots.p6.value) }}
                                                        <td width="20%">{{ getMinutesFromMs(actualSystem.plots.p6.value) }}</td>
                                                        <td width="20%">{{ actualSystem.plots.p6.valvle == "F" ? "Fijo" : "Pulso" }}</td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="6" class="right-align">
                                                            <div class="switch">
                                                                Cíclico
                                                                <label>
                                                                    <span class="blackBg"><b>Off</b></span>
                                                                    <input type="checkbox" ng-model="actualSystem.autoreverse"
                                                                        ng-checked="actualSystem.autoreverse"
                                                                        ng-change="setMachineSettings()">
                                                                    <span class="lever"></span>
                                                                    <span class="redBg"><b>&nbsp;On&nbsp;</b></span>
                                                                </label>
                                                                <label for="frecuencia" ng-show="actualSystem.autoreverse">  cada:
                                                                    <input id="frecuencia" type="number" min="0" max="365" ng-model="actualSystem.frecuencia" 
                                                                    style="width: 45px;">
                                                                    <span>días</span>
                                                                </label>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="row" style="padding: 0 10px;"  ng-show="as_adjust">
                                    <div class="col s12">
                                        <div style="margin-top: 20px;" ng-show="actualSystem.type == 'Estacionario' && as_adjust"></div>
                                        <div class="btn" ng-click="as_adjust = !as_adjust" style="width: 100%;">
                                            <span style="position: absolute; left: 20px;">
                                                <i class="fa fa-cog" aria-hidden="true"></i>
                                            </span>
                                            <span>
                                                Ajustes
                                            </span>
                                            <span style="position: absolute;right: 20px;">
                                                <i class="fa fa-chevron-down" aria-hidden="true" ng-show="!as_adjust"></i>
                                                <i class="fa fa-chevron-up" aria-hidden="true" ng-show="as_adjust"></i>
                                            </span>
                                        </div>
                                        <table class="striped highlight" ng-show="as_adjust">
                                            <tr ng-init="editName = true">
                                                <td style="text-align: left;">Nombre</td>
                                                <td style="text-align: left;"><input type="text" ng-model="actualSystem.name"
                                                        ng-readonly="editName"></td>
                                                <td style="text-align: left;"><i class="fa fa-pencil" aria-hidden="true"
                                                        style="color: grey" ng-click="editName = !editName" ng-show="isSystemOfRole('propietario') || isSystemOfRole('desarrollador')"></i></td>
                                            </tr>
                                            <tr ng-init="editLatitude = true">
                                                <td style="text-align: left;">Latitud central</td>
                                                <td style="text-align: left;"><input type="number"
                                                        ng-model="actualSystem.latitude" ng-readonly="editLatitude"></td>
                                                <td style="text-align: left;"><i class="fa fa-pencil" aria-hidden="true"
                                                        style="color: grey" ng-click="editLatitude = !editLatitude" ng-show="isSystemOfRole('propietario') || isSystemOfRole('desarrollador')"></i></td>
                                            </tr>
                                            <tr ng-init="editLongitude = true">
                                                <td style="text-align: left;">Longitud central</td>
                                                <td style="text-align: left;"><input type="number"
                                                        ng-model="actualSystem.longitude" ng-readonly="editLongitude"></td>
                                                <td style="text-align: left;"><i class="fa fa-pencil" aria-hidden="true"
                                                        style="color: grey" ng-click="editLongitude = !editLongitude" ng-show="isSystemOfRole('propietario') || isSystemOfRole('desarrollador')"></i></td>
                                            </tr>
                                            <!-- <tr ng-init="editStartAngle = true">
                                                <td style="text-align: left;">Ángulo inicial</td>
                                                <td style="text-align: left;"><input type="number"
                                                        ng-model="actualSystem.startAngle" ng-readonly="editStartAngle"></td>
                                                <td style="text-align: left;"><i class="fa fa-pencil" aria-hidden="true"
                                                        style="color: grey" ng-click="editStartAngle = !editStartAngle"></i></td>
                                            </tr>
                                            <tr ng-init="editEndAngle = true">
                                                <td style="text-align: left;">Ángulo final</td>
                                                <td style="text-align: left;"><input type="number"
                                                        ng-model="actualSystem.endAngle" ng-readonly="editEndAngle"></td>
                                                <td style="text-align: left;"><i class="fa fa-pencil" aria-hidden="true"
                                                        style="color: grey" ng-click="editEndAngle = !editEndAngle"></i></td>
                                            </tr> -->
                                            <tr ng-init="editRadio = true" ng-show="actualSystem.type != 'Estacionario'">
                                                <td style="text-align: left;">Radio</td>
                                                <td style="text-align: left;"><input type="number"
                                                        ng-model="actualSystem.length" ng-readonly="editRadio"></td>
                                                <td style="text-align: left;"><i class="fa fa-pencil" aria-hidden="true"
                                                        style="color: grey" ng-click="editRadio = !editRadio" ng-show="isSystemOfRole('propietario') || isSystemOfRole('desarrollador')"></i></td>
                                            </tr>
                                            <tr ng-init="editCaudal = true">
                                                <td style="text-align: left;">Caudal</td>
                                                <td style="text-align: left;"><input type="number"
                                                        ng-model="actualSystem.caudal" ng-readonly="editCaudal"></td>
                                                <td style="text-align: left;"><i class="fa fa-pencil" aria-hidden="true"
                                                        style="color: grey" ng-click="editCaudal = !editCaudal" ng-show="isSystemOfRole('propietario') || isSystemOfRole('desarrollador')"></i></td>
                                            </tr>
                                            <tr ng-init="editSensorPresion = true">
                                                <td style="text-align: left;">Max. val. sensor presión</td>
                                                <td style="text-align: left;"><input type="number"
                                                        ng-model="actualSystem.sensorPresion" ng-readonly="editSensorPresion">
                                                </td>
                                                <td style="text-align: left;"><i class="fa fa-pencil" aria-hidden="true"
                                                        style="color: grey"
                                                        ng-click="editSensorPresion = !editSensorPresion" ng-show="isSystemOfRole('propietario') || isSystemOfRole('desarrollador')"></i></td>
                                            </tr>
                                            <tr ng-init="editMaxVelocity = true">
                                                <td style="text-align: left;">Límite de velocidad</td>
                                                <td style="text-align: left;"><input type="number"
                                                        ng-model="actualSystem.maxVelocity" ng-readonly="editMaxVelocity">
                                                </td>
                                                <td style="text-align: left;"><i class="fa fa-pencil" aria-hidden="true"
                                                        style="color: grey"
                                                        ng-click="editMaxVelocity = !editMaxVelocity" ng-show="isSystemOfRole('propietario') || isSystemOfRole('desarrollador')"></i></td>
                                            </tr>
                                            <!-- <tr ng-init="editMagneticDesv = true">
                                                <td style="text-align: left;">Posición Desv. Magnéticia</td>
                                                <td style="text-align: left;"><input type="number"
                                                        ng-model="actualSystem.magneticDesv" ng-readonly="editMagneticDesv">
                                                </td>
                                                <td style="text-align: left; color: grey;">
                                                    <a href="https://www.magnetic-declination.com/#"><i class="fa fa-globe"
                                                            aria-hidden="true"></i></a>
                                                    <i class="fa fa-pencil" aria-hidden="true"
                                                        ng-click="editMagneticDesv = !editMagneticDesv"></i>
                                                </td>
                                            </tr>
                                            <tr ng-init="editPosManualAdj = true">
                                                <td style="text-align: left;">Posición Ajuste. Manual</td>
                                                <td style="text-align: left;"><input ng-model="actualSystem.posManualAdj"
                                                        ng-readonly="editPosManualAdj"></td>
                                                <td style="text-align: left;"><i class="fa fa-pencil" aria-hidden="true"
                                                        style="color: grey" ng-click="editPosManualAdj = !editPosManualAdj"></i>
                                                </td>
                                            </tr> -->
                                            <tr ng-init="editZona = true">
                                                <td style="text-align: left;">Zona horaria</td>
                                                <td style="text-align: left;">
                                                    <select ng-model="actualSystem.zona" ng-disabled="editZona"
                                                        style="display: block !important;">
                                                        <option ng-selected="actualSystem.zona == -11 ? true : false"
                                                            value="-11">UTC-11 Pacific</option>
                                                        <option ng-selected="actualSystem.zona == -10 ? true : false"
                                                            value="-10">UTC-10 America-Pacific</option>
                                                        <option ng-selected="actualSystem.zona == -9 ? true : false"
                                                            value="-9:30">UTC-9:30 Pacific</option>
                                                        <option ng-selected="actualSystem.zona == -9 ? true : false" value="-9">
                                                            UTC-9 America-Pacific</option>
                                                        <option ng-selected="actualSystem.zona == -8 ? true : false" value="-8">
                                                            UTC-8 America-Pacific</option>
                                                        <option ng-selected="actualSystem.zona == -7 ? true : false" value="-7">
                                                            UTC-7 America</option>
                                                        <option ng-selected="actualSystem.zona == -6 ? true : false" value="-6">
                                                            UTC-6 America-Pacific</option>
                                                        <option ng-selected="actualSystem.zona == -5 ? true : false" value="-5">
                                                            UTC-5 America</option>
                                                        <option ng-selected="actualSystem.zona == -4 ? true : false" value="-4">
                                                            UTC-4 America-Atlantic</option>
                                                        <option ng-selected="actualSystem.zona == -3 ? true : false" value="-3">
                                                            UTC-3 America-Atlantic</option>
                                                        <option ng-selected="actualSystem.zona == -2 ? true : false" value="-2">
                                                            UTC-2 America-Atlantic</option>
                                                        <option ng-selected="actualSystem.zona == -1 ? true : false" value="-1">
                                                            UTC-1 America-Atlantic</option>
                                                        <option ng-selected="actualSystem.zona == +0 ? true : false" value="+0">
                                                            UTC+0 Africa-America-Atlantic-Europe</option>
                                                        <option ng-selected="actualSystem.zona == +1 ? true : false" value="+1">
                                                            UTC+1 Africa-Arctic-Europe</option>
                                                        <option ng-selected="actualSystem.zona == +2 ? true : false" value="+2">
                                                            UTC+2 Africa-Europe</option>
                                                        <option ng-selected="actualSystem.zona == +3 ? true : false" value="+3">
                                                            UTC+3 Africa-Asia-Europe-Indian</option>
                                                        <option ng-selected="actualSystem.zona == +4 ? true : false" value="+4">
                                                            UTC+4 Asia-Europe-Indian</option>
                                                        <option ng-selected="actualSystem.zona == +5 ? true : false" value="+5">
                                                            UTC+5 Antarctica-Asia-Indian</option>
                                                        <option ng-selected="actualSystem.zona == +6 ? true : false" value="+6">
                                                            UTC+6 Antarctica-Asia-Indian</option>
                                                        <option ng-selected="actualSystem.zona == +7 ? true : false" value="+7">
                                                            UTC+7 Antarctica-Asia-Indian</option>
                                                        <option ng-selected="actualSystem.zona == +8 ? true : false" value="+8">
                                                            UTC+8 Asia-Australia </option>
                                                        <option ng-selected="actualSystem.zona == +9 ? true : false" value="+9">
                                                            UTC+9 Asia-Pacific </option>
                                                        <option ng-selected="actualSystem.zona == +10 ? true : false"
                                                            value="+10">UTC+10 Antarctica-Asia-Australia </option>
                                                        <option ng-selected="actualSystem.zona == +10 ? true : false"
                                                            value="+10">UTC+10:30 Australia </option>
                                                        <option ng-selected="actualSystem.zona == +11 ? true : false"
                                                            value="+11">UTC+11 Antarctica-Asia </option>
                                                        <option ng-selected="actualSystem.zona == +12 ? true : false"
                                                            value="+12">UTC+12 Antarctica-Asia </option>
                                                        <option ng-selected="actualSystem.zona == +13 ? true : false"
                                                            value="+13">UTC+13 Pacific </option>
                                                        <option ng-selected="actualSystem.zona == +14 ? true : false"
                                                            value="+14">UTC+14 Pacific </option>
                                                    </select>
                                                </td>
                                                <td style="text-align: left;"><i class="fa fa-pencil" aria-hidden="true"
                                                        style="color: grey" ng-click="editZona = !editZona" ng-show="isSystemOfRole('propietario') || isSystemOfRole('desarrollador')"></i></td>
                                            </tr>
                                            <tr ng-init="editSummerHour = true">
                                                <td style="text-align: left;">Horario verano</td>
                                                <td style="text-align: left;">
                                                    <select ng-model="actualSystem.summerHour" ng-disabled="editSummerHour"
                                                        style="display: block !important;">
                                                        <option ng-selected="actualSystem.summerHour == 0 ? true : false"
                                                            value="0">Normal</option>
                                                        <option ng-selected="actualSystem.summerHour == 1 ? true : false"
                                                            value="1">Verano</option>
                                                    </select>
                                                </td>
                                                <td style="text-align: left;"><i class="fa fa-pencil" aria-hidden="true"
                                                        style="color: grey" ng-click="editSummerHour = !editSummerHour" ng-show="isSystemOfRole('propietario') || isSystemOfRole('desarrollador')"></i>
                                                </td>
                                            </tr>
                                            <tr ng-show="isSystemOfRole('propietario') || isSystemOfRole('desarrollador')">
                                                <td colspan="3" class="right-align">
                                                    <a href="#!"
                                                        class="modal-close waves-effect teal waves-green btn-flat white-text"
                                                        ng-click="setMachineSettings()">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i class="material-icons">check</i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <div class="row" style="padding: 0 10px;"  ng-show="as_more">
                                    <div class="col s12">
                                        <div style="margin-top: 20px;" ng-show="actualSystem.type == 'Estacionario' && as_more"></div>
                                        <div class="btn" ng-click="as_more = !as_more" style="width: 100%;">
                                            <span style="position: absolute; left: 20px;">
                                                <i class="fa fa-info-circle" aria-hidden="true"></i>
                                            </span>
                                            <span>
                                                Datos generales
                                            </span>
                                            <span style="position: absolute;right: 20px;">
                                                <i class="fa fa-chevron-down" aria-hidden="true" ng-show="!as_more"></i>
                                                <i class="fa fa-chevron-up" aria-hidden="true" ng-show="as_more"></i>
                                            </span>
                                        </div>
                                        <table class="striped highlight" ng-show="as_more">
                                            <tr>
                                                <td style="text-align: left;">Sistema</td>
                                                <td style="text-align: left;"><b><i>{{ actualSystem.type }}</b></i></td>
                                            </tr>
                                            <tr ng-show="actualSystem.type == 'PC' || actualSystem.type == 'PL'">
                                                <td style="text-align: left;">Marca</td>
                                                <td style="text-align: left;"><b><i>{{ actualSystem.brand }}</b></i></td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: left;">Instalación</td>
                                                <td style="text-align: left;"><b><i>{{ actualSystem.installation }}</b></i></td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: left;">Id Usuario</td>
                                                <td style="text-align: left;"><b><i>{{ actualSystem.key }}</i></b></td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: left;">Ubicación</td>
                                                <td style="text-align: left;"><b><i>{{ actualSystem.latitude }}, {{
                                                        actualSystem.longitude }}</i></b>
                                                </td>
                                            </tr>
                                            <tr ng-show="actualSystem.type == 'PC' || actualSystem.type == 'PL'">
                                                <td style="text-align: left;">Posición</td>
                                                <td style="text-align: left;">
                                                    <i><b>
                                                            {{ actualSystem.log.latitude ? actualSystem.log.latitude : 0 }}, {{
                                                            actualSystem.log.longitude ? actualSystem.log.longitude : 0 }}
                                                        </b></i>
                                                </td>
                                            </tr>
                                            <tr ng-show="actualSystem.type == 'PC' || actualSystem.type == 'PL'">
                                                <td style="text-align: left;">Precisión</td>
                                                <td style="text-align: left;"><i><b>{{ actualSystem.log.error ?
                                                            actualSystem.log.error : 0 }}</b> cm</i>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: left;">Clima:</td>
                                                <td style="text-align: left;"><b><img src="{{ meteo[actualSystem.key].weather.iconUrl }}" alt="Weather icon"></b></td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: left;">Temperatura:</td>
                                                <td style="text-align: left;"><b>{{ meteo[actualSystem.key].main.temp - 273.15 | number : 2}}°C ~ {{ meteo[actualSystem.key].main.temp }}°K</b></td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: left;">Presión:</td>
                                                <td style="text-align: left;"><b>{{ meteo[actualSystem.key].main.pressure }}hPa</b></td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: left;">Humedad:</td>
                                                <td style="text-align: left;"><b>{{ meteo[actualSystem.key].main.humidity }}%</b></td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: left;">Velocidad del viento: </td>
                                                <td style="text-align: left;"><b>{{ meteo[actualSystem.key].wind.speed }}km/h</b></td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <div class="row" style="padding: 0 10px;"  ng-show="as_hist">
                                    <div class="col s12">
                                        <div style="margin-top: 20px;" ng-show="actualSystem.type == 'Estacionario' && as_hist"></div>
                                        <div class="btn" ng-click="as_hist = !as_hist" style="width: 100%;">
                                            <span style="position: absolute; left: 20px;">
                                                <i class="fa fa-history" aria-hidden="true"></i>
                                            </span>
                                            <span>
                                                Historial
                                            </span>
                                            <span style="position: absolute;right: 20px;">
                                                <i class="fa fa-chevron-down" aria-hidden="true" ng-show="!as_hist"></i>
                                                <i class="fa fa-chevron-up" aria-hidden="true" ng-show="as_hist"></i>
                                            </span>
                                        </div>
                                        <!-- <div class="center-align" ng-click="loadSystemLog(actualSystem.key, 1000)"><b>Ver más...</b></div> -->
                                        <ul class="row collapsible" ng-show="as_hist" style="padding: 0 10px; margin: 0px;">
                                            <p></p>
                                            <!-- <div class="col s12" ng-repeat="reg in logs[actualSystem.key] | orderBy: '-date'"> -->
                                            <li class="col s12" ng-repeat="reg in invertedRegisters">
                                                <div class="sercices-options gray-text white collapsible-header row"
                                                    ng-click="modalLogDetail_$index = !modalLogDetail_$index"
                                                    ng-show="actualSystem.type == 'PC' || actualSystem.type == 'PL'"
                                                    style="background: {{ reg.state == 'ON' && reg.voltage == 'false' ? 'red !important' : 
                                                            reg.state == 'ON' && reg.safety == 'false' ? 'palevioletred !important' : 
                                                            reg.state == 'ON' ? 'lightseagreen !important' : 'lightgray !important' }}; 
                                                            color: {{ reg.state == 'OFF' ? 'black' : 'white' }};">
                                                    <div class="col s12">
                                                        <b>{{ reg.state == 'ON' && reg.voltage == 'false' ? 'Falla de Electricidad' : 
                                                            reg.state == 'ON' && reg.safety == 'false' ? 'Falla de Seguridad' : 
                                                            reg.state == 'ON' ? 'Sistema Encendido' : 'Sistema Apagado' }}</b><br>
                                                        <span style="font-size: .7em;">[{{ reg.date }} - {{ reg.update }}]</span> <br>
                                                        <i class="fa fa-undo" style="font-size: .8em; width: 10px;"
                                                            ng-show="reg.direction == 'RR'"></i>
                                                        <i class="fa fa-repeat" style="font-size: .8em; width: 10px;"
                                                            ng-show="reg.direction == 'FF'"></i>
                                                        <span style="font-size: .8em;">
                                                            <i class="material-icons" style="font-size: .9em; width: 10px;">near_me</i>
                                                            {{ reg.position ? reg.position : 0 }}°&nbsp;&nbsp;&nbsp;
                                                        </span>
                                                        <span style="font-size: .8em;">
                                                            <i class="material-icons" style="font-size: .9em; width: 10px;">network_check</i>
                                                            {{ reg.speed ? reg.speed : 0}}%&nbsp;&nbsp;&nbsp;
                                                        </span>
                                                        <span style="font-size: .8em;">
                                                            <i class="fa fa-tint" aria-hidden="true" style="width: 10px;"></i>
                                                            {{ reg.presion == 0 ? "0.00" : reg.presion < 1 ? "Presión Baja" : "Presión Normal" }} 
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="sercices-options gray-text white collapsible-header row"
                                                    ng-click="modalLogDetail_$index = !modalLogDetail_$index"
                                                    ng-show="actualSystem.type == 'Estacionario'"
                                                    style="background: {{ reg.state == 'ON' ? 'lightseagreen !important' : 'lightgray !important' }}; color: {{ reg.state == 'ON' ? 'white' : 'black' }};">
                                                    <div class="col 12">
                                                        <span style="font-size: .9em;"><b>{{ reg.state == "ON" ? "Sistema Encendido" : "Sistema Apagado" }}</b></span><br>
                                                    </div>
                                                </div>
                                                <div class="collapsible-body" style="padding: 1rem; font-size: 1em;">
                                                    <p>Fecha inicial: <b>{{ reg.date }}</b></p>
                                                    <p>Actualización: <b>{{ reg.update }}</b></p>
                                                    <p ng-show="actualSystem.type == 'Estacionario'">Parcela: <b>{{ strToInt(reg.plot) + 1 }}</b></p>
                                                    <p ng-show="actualSystem.type == 'Estacionario'">Tiempo activación: <b>{{ msToTime(reg.activationTime) }}</b></p>
                                                    <p ng-show="actualSystem.type == 'PC'">Presión: <b>{{ reg.presion < 1 ? "Presión Baja" : "Presión Normal" }}</b></p>
                                                    <p ng-show="actualSystem.type == 'PC'">Dirección: <b>{{ reg.direction }}</b></p>
                                                    <p ng-show="actualSystem.type == 'PC'">Velocidad: <b>{{ reg.speed }}</b></p>
                                                    <p ng-show="actualSystem.type == 'PC'">Latitud: <b>{{ reg.latitude }}</b></p>
                                                    <p ng-show="actualSystem.type == 'PC'">Longitud: <b>{{ reg.longitude }}</b></p>
                                                    <p ng-show="actualSystem.type == 'PC'">Posición: <b>{{ reg.position }}</b></p>
                                                    <p ng-show="actualSystem.type == 'PC'">Presión: <b>{{ reg.presion }}</b></p>
                                                    <p ng-show="actualSystem.type == 'PC'">Recepción: <b>{{ reg.reception }}</b></p>
                                                    <p ng-show="actualSystem.type == 'PC'">Autoreversa: <b>{{ reg.autoreverse }}</b></p>
                                                    <p ng-show="actualSystem.type == 'PC'">Seguridad: <b>{{ reg.safety }}</b></p>
                                                    <p ng-show="actualSystem.type == 'PC'">Voltaje: <b>{{ reg.voltage }}</b></p>
                                                    <p>Señal: <b>{{ reg.signal }}</b></p>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="row" style="padding: 0 10px;"  ng-show="as_users">
                                    <div class="col s12">
                                        <div style="margin-top: 20px;" ng-show="actualSystem.type == 'Estacionario' && as_users"></div>
                                        <div class="btn" ng-click="as_users = !as_users" style="width: 100%;">
                                            <span style="position: absolute; left: 20px;">
                                                <i class="fa fa-users" aria-hidden="true"></i>
                                            </span>
                                            <span>
                                                Usuarios
                                            </span>
                                            <span style="position: absolute;right: 20px;">
                                                <i class="fa fa-chevron-down" aria-hidden="true" ng-show="!as_users"></i>
                                                <i class="fa fa-chevron-up" aria-hidden="true" ng-show="as_users"></i>
                                            </span>
                                        </div>
                                        <div class="row" ng-show="as_users" style="margin: auto;">
                                            <p></p>
                                            <div class="col s12" ng-repeat="reg in users[actualSystem.key]" ng-show="reg.alias != authUser.displayName">
                                                <div class="sercices-options gray-text white">
                                                    <div class="row" style="margin-bottom: 0;">
                                                        <div class="col s9 m10">
                                                            <div class="row" style="margin-bottom: 0;">
                                                                <div class="col s1"><i class="fa fa-user" aria-hidden="true" style="margin-top: 5px;"></i> </div>
                                                                <div class="col s10">{{ reg.alias }} <br> [{{ reg.role }}]</div>
                                                            </div>
                                                        </div>
                                                        <div class="col s3 m2 right-align">
                                                            <i class="fa fa-trash-o" aria-hidden="true" 
                                                                ng-click="deleteUser(actualSystem.key, reg.alias)"
                                                                ng-show="reg.role != 'propietario'"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col s12" ng-show="isSystemOfRole('propietario') || isSystemOfRole('desarrollador')">
                                                <div class="sercices-options gray-text white text-centered modal-trigger" href="#modalAddUser">
                                                    <i class="fa fa-plus" aria-hidden="true" style="margin-top: 5px;"></i> 
                                                    Invitar a alguien
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <p style="margin-bottom: 70px;"></p>

                        </div>
                    </div>

                    <!-- Modal plan de riego -->
                    <div id="modalAddUser" class="modal">
                        <div class="modal-content">
                            <h6>Invitar a alguien</h6>
                            <div class="row" style="margin-top: 35px;">
                                <div class="input-field col s12">
                                    <input id="newUserEmail" type="text" ng-model="newUserEmail">
                                    <label>Correo electrónico</label>
                                </div>
                                <div class="input-field col s12">
                                    <input id="newUserName" type="text" ng-model="newUserName">
                                    <label>Nombre</label>
                                </div>
                                <div class="input-field col s12">
                                    <select id="newUserRole" style="display:block;" ng-model="newUserRole">
                                        <option value="propietario">Propietario</option>
                                        <option value="trabajador" selected="selected">Trabajador</option>
                                        <option value="observador">Observador</option>
                                    </select>
                                    <label style="top: -28px; font-size: .8em;">Role</label>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <a href="#!" class="modal-close waves-effect grey waves-grey btn-flat white-text">
                                <i class="material-icons">&nbsp;&nbsp;reply&nbsp;&nbsp;</i></a>
                            <a href="#!" class="modal-close waves-effect teal waves-green btn-flat white-text"
                                ng-click="addNewUserToDevice()"><i
                                    class="material-icons">&nbsp;&nbsp;check&nbsp;&nbsp;</i></a>
                        </div>
                    </div>

                    <div id="modalRiego" class="modal">
                        <div class="modal-content">
                            <h6>Agregar nueva planificación</h6>
                            <div class="row" style="margin-top: 35px;">
                                <div class="input-field col s6">
                                    <input id="planAnguloIni" type="number" placeholder="0" min="0" max="360">
                                    <label>Ángulo inicial</label>
                                </div>
                                <div class="input-field col s6">
                                    <input id="planAnduloFin" type="number" placeholder="360" min="0" max="360">
                                    <label>Ángulo final</label>
                                </div>
                                <div class="input-field col s4 m6">
                                    <select id="planEndGun" style="display:block; ">
                                        <option value="true">Sí</option>
                                        <option value="false">No</option>
                                    </select>
                                    <label style="top: -28px; font-size: .8em;">Activar Pistola</label>
                                </div>
                                <div class="input-field col s4 m4">
                                    <input id="planValue" type="number" placeholder="0" min="0">
                                    <label>Velocidad/Volumen</label>
                                </div>
                                <div class="input-field col s4 m2">
                                    <div class="btn waves-effect waves-light modal-trigger" href="#systemConfigModal"
                                        style="width: 100%; margin-top: 5px;">
                                        <i class="material-icons"
                                            ng-click="showSystemTable(actualSystem.brand)">help_outline</i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <a href="#!" class="modal-close waves-effect grey waves-grey btn-flat white-text"
                                ng-click="resetNewPlan()"><i class="material-icons">&nbsp;&nbsp;reply&nbsp;&nbsp;</i></a>
                            <a href="#!" class="modal-close waves-effect teal waves-green btn-flat white-text"
                                ng-click="setNewPlan(-1, -1, -1, false)"><i
                                    class="material-icons">&nbsp;&nbsp;check&nbsp;&nbsp;</i></a>
                        </div>
                    </div>

                    <div id="modalEditRiego" class="modal">
                        <div class="modal-content">
                            <h6>Editar planificación</h6>
                            <div class="row" style="margin-top: 35px;">
                                <div class="input-field col s6">
                                    <input id="editPlanAnguloIni" type="number" placeholder="0" min="0" max="360"
                                        ng-model="editPlan.editPlanAnguloIni">
                                    <label>Ángulo inicial</label>
                                </div>
                                <div class="input-field col s6">
                                    <input id="editPlanAnduloFin" type="number" placeholder="360" min="0" max="360"
                                        ng-model="editPlan.editPlanAnduloFin">
                                    <label>Ángulo final</label>
                                </div>
                                <div class="input-field col s4 m6">
                                    <select id="editEndGun" ng-model="editPlan.editPlanType" style="display:block; ">
                                        <option value="true">Sí</option>
                                        <option value="false">No</option>
                                    </select>
                                    <label style="top: -28px; font-size: .8em;">Activar Pistola</label>
                                </div>
                                <div class="input-field col s4 m4">
                                    <input id="editPlanValue" type="number" placeholder="0" min="0"
                                        ng-model="editPlan.editPlanValue">
                                    <label>Velocidad/Volumen</label>
                                </div>
                                <!-- <div class="input-field col s4 m4">
                                    <p class="range-field">
                                        <input type="range" id="test5" min="0" max="100" />
                                    </p>
                                    <label>Velocidad/Volumen</label>
                                </div> -->
                                <div class="input-field col s4 m2">
                                    <div class="btn waves-effect waves-light modal-trigger" href="#systemConfigModal"
                                        style="width: 100%; margin-top: 5px;">
                                        <i class="material-icons"
                                            ng-click="showSystemTable(actualSystem.brand)">help_outline</i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <a href="#!" class="modal-close waves-effect grey waves-grey btn-flat white-text">
                                <i class="material-icons">&nbsp;&nbsp;reply&nbsp;&nbsp;</i></a>
                            <a href="#!" class="modal-close waves-effect teal waves-green btn-flat white-text"
                                ng-click="editPlan()"><i class="material-icons">&nbsp;&nbsp;check&nbsp;&nbsp;</i></a>
                        </div>
                    </div>

                    <div id="modalResetRiego" class="modal">
                        <div class="modal-content">
                            <h6>Eliminar la planificación</h6>
                            <div class="row" style="margin-top: 35px;">
                                Esto eliminará toda la programación del riego. ¿Seguro desea continuar?
                            </div>
                        </div>
                        <div class="modal-footer">
                            <a href="#!" class="modal-close waves-effect waves-green btn-flat">Cancelar</a>
                            <a href="#!" class="modal-close waves-effect waves-green btn-flat"
                                ng-click="deletePlan()">Eliminar</a>
                        </div>
                    </div>

                    <div id="modalEditRiegoEstacionario" class="modal">
                        <div class="modal-content">
                            <h6>Editar planificación</h6>
                            <div class="row" style="margin-top: 35px;">
                                <div class="input-field col s12">
                                    <label>Polígono</label>
                                    <textarea id="editPoligon" rows="4" cols="50"
                                        placeholder="[[lat1, lon1], [lat2, lon2]]"></textarea>
                                </div>
                                <div class="input-field col s4">
                                    <input id="editDay" type="number" placeholder="0" min="0" max="365" value="0">
                                    <label>Días</label>
                                </div>
                                <div class="input-field col s4">
                                    <input id="editHour" type="number" placeholder="0" min="0" max="24" value="0">
                                    <label>Horas</label>
                                </div>
                                <div class="input-field col s4">
                                    <input id="editMinutes" type="number" placeholder="0" min="0" max="60" value="0">
                                    <label>Minutos</label>
                                </div>
                                <div class="input-field col s12 m6">
                                    <select id="editType" class="select">
                                        <option value="F">Normalmente cerrada</option>
                                        <option value="P">Activación por pulso</option>
                                      </select>
                                    <label>Tipo de electroválvula</label>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <input id="planEstacionarioId" type="hidden">
                            <a href="#!" class="modal-close waves-effect grey waves-grey btn-flat white-text">
                                <i class="material-icons">&nbsp;&nbsp;reply&nbsp;&nbsp;</i></a>
                            <a href="#!" class="modal-close waves-effect teal waves-green btn-flat white-text"
                                ng-click="editPlanEstacionario()"><i
                                    class="material-icons">&nbsp;&nbsp;check&nbsp;&nbsp;</i></a>
                        </div>
                    </div>
                    
                    <div id="modalConfirmRiegoMovimiento" class="modal">
                        <div class="modal-content">
                            <h6>Confirmar cambios</h6>
                            <div class="row" style="margin-top: 35px;">
                                 <div class="col 4">
                                    <i class="material-icons">check_circle</i>
                                 </div>                               
                                 <div class="col 8">
                                    ¿Desea confirmar los cambios realizados?
                                 </div>                               
                            </div>
                        </div>
                        <div class="modal-footer">
                            <a href="#!" class="modal-close waves-effect grey waves-grey btn-flat white-text">
                                <i class="material-icons">&nbsp;&nbsp;reply&nbsp;&nbsp;</i></a>
                            <a href="#!" class="modal-close waves-effect teal waves-green btn-flat white-text"
                                ng-click="continuePlanMovimiento()"><i
                                    class="material-icons">&nbsp;&nbsp;check&nbsp;&nbsp;</i></a>
                        </div>
                    </div>
                    
                    <div id="modalConfirmRiegoEstacionario" class="modal">
                        <div class="modal-content">
                            <h6>Confirmar cambios</h6>
                            <div class="row" style="margin-top: 35px;">
                                 <div class="col 4">
                                    <i class="material-icons">check_circle</i>
                                 </div>                               
                                 <div class="col 8">
                                    ¿Desea confirmar los cambios realizados?
                                 </div>                               
                            </div>
                        </div>
                        <div class="modal-footer">
                            <a href="#!" class="modal-close waves-effect grey waves-grey btn-flat white-text">
                                <i class="material-icons">&nbsp;&nbsp;reply&nbsp;&nbsp;</i></a>
                            <a href="#!" class="modal-close waves-effect teal waves-green btn-flat white-text"
                                ng-click="continuePlanEstacionario()"><i
                                    class="material-icons">&nbsp;&nbsp;check&nbsp;&nbsp;</i></a>
                        </div>
                    </div>
                    
                </section>

                <!-- #endregion: SISTEMA -->

                <!-- #region: SERVICIOS -->

                <section>

                    <div id="servicios" class="container" ng-show="selectedWindow == 'servicios'">
                        <div class="main-container text-center our-services">
                            <div class="show-in-mobil-only" style="margin-top: 50px;"></div>
                            <ul>
                                <!-- <li ng-click="showWindow('mapas')" class="sercices-options modal-trigger">
                                    <i class="fa fa-map-marker" aria-hidden="true"></i>Vista global (Mapa)
                                </li> -->
                                <li ng-click="showWindow('listado')"
                                    class="sercices-options modal-trigger teal darken white-text">
                                    <i class="fa fa-list" aria-hidden="true"></i>Mis riegos
                                </li>
                                <li ng-click="createNewDevice()" class="sercices-options modal-trigger teal darken white-text"
                                    href="#modalNuevoEquipo">
                                    <i class="fa fa-plus" aria-hidden="true"></i>Agregar equipo
                                </li>
                                <section style="display: block;">
                                    <li ng-click="loadCultures()" class="sercices-options teal darken white-text">
                                        <i class="fa fa-leaf" aria-hidden="true"></i>Fichas Técnicas
                                    </li>
                                    <li ng-click="selectPlanRiego()" class="sercices-options teal darken white-text">
                                        <i class="fa fa-calendar" aria-hidden="true"></i>Planificar Riego
                                    </li>
                                    <li ng-click="automatizaciones()" class="sercices-options teal darken white-text">
                                        <i class="fa fa-magic" aria-hidden="true"></i>Automatizaciones
                                    </li>
                                </section>
                                <li ng-click="showWindow('estadisticas')" class="sercices-options teal darken white-text"
                                    style="display: none;">
                                    <i class="fa fa-bar-chart-o" aria-hidden="true"></i>Estadísiticas (Reportes)
                                </li>
                                <li ng-click="showWindow('users')" class="sercices-options teal darken white-text" 
                                    style="display: none;">
                                    <i class="fa fa-users" aria-hidden="true"></i>Perfil de usuario
                                </li>
                                <li ng-click="showWindow('notificaciones')" class="sercices-options teal darken white-text" 
                                    style="display: none;">
                                    <i class="fa fa-bell-o" aria-hidden="true"></i>Notificaciones
                                </li>
                                <li id="installBtn2" onclick="instalar()" class="sercices-options teal darken white-text">
                                    <i class="fa fa-check-square-o" aria-hidden="true"></i>Instalar la aplicación
                                </li>
                                <li ng-click="reload()" class="sercices-options teal darken white-text">
                                    <i class="fa fa-download" aria-hidden="true"></i>Actualizar el sistema
                                </li>
                                <li class="sercices-options teal darken white-text">
                                    <a href="#!/ayuda" style="color: white; text-decoration: none;">
                                        <div>
                                            <i class="fa fa-question" aria-hidden="true"></i>Ayuda
                                        </div>
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <hr style="width: 30%" ng-show="selectedWindow == 'home'">
                    </div>
    
                    <div id="fichasTecnicas" class="container ventanaServicios" ng-show="selectedWindow == 'fichasTecnicas'">
                        <p class="sercices-options teal darken white-text"><b>Fichas Tecnicas</b></p>
                        <div>
                            <div style="width: 90%; margin: auto;">
                                <ul>
                                    <li ng-repeat="plan in listPlanesRiego" style="box-shadow: 1px 1px 3px grey; cursor: pointer; border-radius: 5px;">
                                        <!-- <div class="row modal-trigger" href="#fichaTecnica" style="margin-bottom: 10px;"> -->
                                        <div class="row" ng-click="showFichaTecnicaModal(plan)" style="margin-bottom: 10px;">
                                            <div class="col s2 center-align">
                                                <i class="material-icons" style="font-size: 2.5em;">{{ plan.price != "0.00" ? "art_track" : "done"}}</i>
                                            </div>
                                            <div class="col s8 left-align">
                                                <span style="font-size: 1.5em;">{{ plan.culture }}</span>
                                                <span>
                                                    {{ plan.detail != "" ? "(" + plan.detail + ")" : "" }}
                                                </span>
                                            </div>
                                            <div class="col s2" style="color: {{ plan.price != '0.00' ? 'red' : 'green' }};">
                                                <i class="material-icons" style="font-size: 1.8em; margin-top: 5px;">{{ plan.price != '0.00' ? "attach_money" : "money_off" }}</i>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <br>
                        <br>
                    </div>

                    <!-- Modal ficha técnica -->
                    <div id="fichaTecnica" class="modal">
                        <div class="modal-content">
                            <h4 class="show-in-pc-only">Ficha Técnica del {{ selectedPlaneRiego.culture }}</h4>
                            <h5 class="show-in-mobil-only" style="border-bottom: 1px solid; text-align: center;">
                                Ficha Técnica del {{ selectedPlaneRiego.culture }}
                            </h5>
                            <div style="margin-top: 35px;">
                                <ul>
                                    <li ng-repeat="plan in selectedPlaneRiego.plan | orderBy : getNumber">
                                        <div class="row">
                                            <div class="col s2 center-align">
                                                <span style="font-size: 1.5em;">{{ plan.day }}</span><br>
                                                <span>días</span>
                                            </div>
                                            <div class="col s10 left-align" style="width: 80%; border-bottom: 1px solid;">
                                                <span style="font-size: 1.5em;">{{ plan.action }}</span><br />
                                                <span>{{ plan.detail }} &nbsp;</span>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <a href="#!" class="modal-close waves-effect grey waves-grey btn-flat white-text">
                                <i class="material-icons">&nbsp;&nbsp;check&nbsp;&nbsp;</i></a>
                        </div>
                    </div>
    
                    <div id="planificarRiego" class="container ventanaServicios" ng-show="selectedWindow == 'planificarRiego'" >
                        <p class="sercices-options teal darken white-text"><b>Plan de Riego del {{ listPlanesRiego.culture }}</b></p>
                        <div>
                            <div style="width: 80%; margin: auto;">
                                <table class="striped highlight">
                                    <thead>
                                        <tr>
                                            <th>Sistema de riego</th>
                                            <th>Cultivo</th>
                                            <th>&nbsp;</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="system in systems" style="cursor: pointer;">
                                            <td style="text-align: left;">{{ system.name }}</td>
                                            <td>
                                                <span class="show-in-pc-only">No asignado</span>
                                                <span class="show-in-mobil-only">~</span>
                                            </td>
                                            <td>
                                                <a class='dropdown-trigger' href='#' data-target='dropdown{{ $index }}'>
                                                    <i class="material-icons">create</i>
                                                </a>
                                                <ul id='dropdown{{ $index }}' class='dropdown-content'>
                                                    <li ng-repeat="plan in listPlanesRiego" ng-click="selectCulture(system.name)"><a href="#!">{{ plan.culture }}</a></li>
                                                </ul>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <br>
                        <br>
                    </div>
    
                    <div id="automatizaciones" class="container ventanaServicios" ng-show="selectedWindow == 'automatizaciones'">
                        <!-- <h5 style="border-bottom: solid;">Ayuda</h5> -->
                        <p class="sercices-options teal darken white-text"><b>Automatizaciones</b></p>
                        <div>
                            
                        </div>
                        <br>
                        <br>
                    </div>

                </section>

                <!-- #endregion: SERVICIOS -->

                <!-- #region: ESTADÍSTICAS -->

                <section id="estadisticas" ng-show="selectedWindow == 'estadisticas'">

                    <div class="container">
                        <div class="main-container text-center our-services">
                            <div class="row">
                                <!-- <div class="input-field col s12">
                                    <label for="statisticSystemSelector">Seleccionar sistema</label>
                                    <select id="statisticSystemSelector" ng-model="statisticSelectedSystem" ng-options="system.name for system in systems">
                                    </select>
                                    <select class="select" ng-model="statisticSelectedSystem">
                                        <option value="" disabled selected>Seleccione un sistema</option>
                                        <option value="{{ system.key }}" ng-repeat="system in systems">{{ system.name }}</option>
                                    </select>
                                </div> -->
                                <h5 class="col s12">{{ statisticSelectedSystem.name }}</h5>
                                <div class="col m12 sm12 xs12">
                                </div>
                                <div class="col m12 sm12 xs12"
                                    style="background-color: rgba(255,255,255,0.9); box-shadow: 4px 4px 4px grey;">
                                    <div class="dashboard_graph x_panel">
                                        <div class="row x_title">
                                            <div class="col m6">
                                                <h5>Agua <small>Consumo actual</small></h5>
                                            </div>
                                            <div class="col m6">
                                                <div id="reportrange" class="pull-right"
                                                    style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc">
                                                    <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>
                                                    <span>Enero 01, 2020 - Mayo 20, 2020</span> <b class="caret"></b>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="x_content">
                                            <div class="demo-container" style="height:250px">
                                                <div id="placeholder3xx3a" class="demo-placeholder"
                                                    style="width: 100%; height:250px;">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col m12 sm12 xs12"
                                    style="background-color: rgba(255,255,255,0.9); box-shadow: 4px 4px 4px grey;">
                                    <div class="dashboard_graph x_panel">
                                        <div class="row x_title">
                                            <div class="col m6">
                                                <h5>Fertilizantes <small>Consumo actual</small></h5>
                                            </div>
                                            <div class="col m6">
                                                <div id="reportrange" class="pull-right"
                                                    style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc">
                                                    <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>
                                                    <span>Enero 01, 2020 - Mayo 20, 2020</span> <b class="caret"></b>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="x_content">
                                            <div class="demo-container" style="height:250px">
                                                <div id="placeholder3xx3b" class="demo-placeholder"
                                                    style="width: 100%; height:250px;">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </section>

                <!-- #endregion: ESTADÍSTICAS -->

                <!-- #region: NOTIFICACIONES -->

                <section id="notificaciones" ng-show="selectedWindow == 'notificaciones'">

                    <div class="container">
                        <div class="main-container text-center our-services">
                            <ul>
                                <li id="suscribe" ng-click="setToken()" class="sercices-options teal darken white-text">
                                    <i class="fa fa-check-square-o" aria-hidden="true"></i>
                                    Suscribirse para recibir notificaciones
                                </li>
                                <li id="unsuscribe" ng-click="deleteToken()" class="sercices-options teal darken white-text">
                                    <i class="fa fa-square-o" aria-hidden="true"></i>
                                    Desuscribirse para silenciar notificaciones
                                </li>
                            </ul>
                            <p id="tokenViewer">No tiene ninguna notificación</p>
                        </div>
                    </div>

                </section>

                <audio id="alertSound">
                    <source src="./assets/sounds/alarma-de-evacuacin-evacuacion.mp3" type="audio/mpeg">
                    Your browser does not support the audio element.
                </audio>

                <!-- #endregion: NOTIFICACIONES -->

                <!-- #region: AYUDA -->

                <section id="ayuda">

                    <div class="container" ng-show="selectedWindow == 'ayuda'">
                        <br>
                        <br>
                        <div class="row sercices-options white">
                            <div class="col s12">
                                <h4 class="center-align" style="border-bottom: solid 1px antiquewhite;">
                                    <strong>Ayuda</strong>
                                </h4>
                            </div>
                            <div class="col s12 m6 l3">
                                <div class="center-align">
                                    <i class="material-icons" style="font-size: 3em;">devices</i>
                                </div>
                                <h5 class="center-align"><strong>Monitorea</strong></h5>
                                <p>Mapea la información de tus sistemas de riego y bombeo. Conoce las condiciones climáticas de tus parcelas.</p>
                                <a class="waves-effect waves-light btn" href="https://dtaamerica.com/dta-agricola/DTA-Control.html"><i class="material-icons left">open_in_new</i>Ir</a>
                            </div>
                            <div class="col s12 m6 l3">
                                <div class="center-align">
                                    <i class="material-icons" style="font-size: 3em;">phonelink_ring</i>
                                </div>
                                <h5 class="center-align"><strong>Controla</strong></h5>
                                <p>Automatización agrícola. Ajusta las prácticas de cultivo a las necesidades del suelo y las plantas con la ayuda de IA.</p>
                                <a class="waves-effect waves-light btn" href="https://dtaamerica.com/dta-agricola/DTA-Planning.html"><i class="material-icons left">open_in_new</i>Ir</a>
                            </div>
                            <div class="col s12 m6 l3">
                                <div class="center-align">
                                    <i class="material-icons" style="font-size: 3em;">phonelink_setup</i>
                                </div>
                                <h5 class="center-align"><strong>Procesa</strong></h5>
                                <p>Inteligencia Artificial colectiva. Asistencia inteligente para la toma de decisiones que el agricultor debe anticipar.</p>
                                <a class="waves-effect waves-light btn" href="https://dtaamerica.com/dta-agricola/index.html#content6-n"><i class="material-icons left">open_in_new</i>Ir</a>
                            </div>
                            <div class="col s12 m6 l3">
                                <div class="center-align">
                                    <i class="material-icons" style="font-size: 3em;">trending_up</i>
                                </div>
                                <h5 class="center-align"><strong>Mejora</strong></h5>
                                <p>Incrementa la productividad con la aplicación de buenas prácticas de manejo de cultivos.</p><br>
                                <a class="waves-effect waves-light btn" href="https://dtaamerica.com/dta-agricola/index.html#content6-m"><i class="material-icons left">open_in_new</i>Ir</a>
                            </div>
                            <div class="col s12">
                                <ul class="collapsible">
                                    <li>
                                        <div class="collapsible-header"><i class="material-icons">dashboard</i>Sistemas de estacionarios</div>
                                        <div class="collapsible-body">
                                            <h5><strong>DripControl</strong></h5>
                                            <p>¿Cuenta con sistemas de riego por aspersión, por difusión, por goteo, subterráneo o cintas de exudación? ¿Cuenta con un único pozo para irrigar múltiples parcelas o cultivos? DripControl le permitirá monitorear y controlar en tiempo real un pozo y hasta 3, 7 ó 15 electroválvulas en dependencia de la versión de que disponga. Así como implementar tu propio plan de riego.</p>
                                            <p><strong>Instalación</strong></p>
                                            </p>
                                            <div class="row">
                                                <div class="col s6 m3"><strong>Conexiones:</strong></div>
                                                <div class="col s6 m9">
                                                    <a href="./assets/documents/Cableado - Estacionario 1.webp"><i class="material-icons">photo_library</i></a> &nbsp; 
                                                    <a href="./assets/documents/Cableado - Estacionario 2.webp"><i class="material-icons">photo_library</i></a> &nbsp; 
                                                    <a href="./assets/documents/Cableado - Estacionarios.pdf"><i class="material-icons">picture_as_pdf</i></a>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="collapsible-header"><i class="material-icons">access_time</i>Sistemas de movimiento continuo</div>
                                        <div class="collapsible-body">
                                            <h5><strong>PivotControl</strong></h5>
                                            <p>¿Desea reducir el tiempo que consume revisando sus pivotes, el combustible invertido y el mantenimiento de sus sistemas de riego debido a fallas de funcionamiento? ¿Los sistemas de monitoreo y control de pivotes en el mercado no le ofrecen todas las características que está buscando o resultan demasiado complejos y costosos? PivotControl es un sistema de monitoreo y control en tiempo real, basado en tecnología GPS, avanzado y sencillo de usar desde su teléfono celular o computadora. </p>
                                            <div>
                                                <u>Conexiones:</u> 
                                                <div class="row">
                                                    <div class="col s6 m3"><strong>Panel:</strong></div>
                                                    <div class="col s6 m9">
                                                        <a href="./assets/documents/Cableado - Panel.webp"><i class="material-icons">photo_library</i></a> &nbsp; &nbsp;
                                                        <a href="./assets/documents/Cableado.pdf"><i class="material-icons">picture_as_pdf</i></a>
                                                    </div>
                                                    <div class="col s6 m3"><strong>Valley:</strong></div>
                                                    <div class="col s6 m9">
                                                        <a href="./assets/documents/Cableado - Valley.webp"><i class="material-icons">photo_library</i></a> &nbsp; &nbsp;
                                                        <a href="./assets/documents/Cableado - Valley.pdf"><i class="material-icons">picture_as_pdf</i></a>
                                                    </div>
                                                    <div class="col s6 m3"><strong>ZIMMATIC:</strong></div>
                                                    <div class="col s6 m9">
                                                        <a href="./assets/documents/Cableado - ZIMMATIC.webp"><i class="material-icons">photo_library</i></a> &nbsp; &nbsp;
                                                        <a href="./assets/documents/Cableado - ZIMMATIC.pdf"><i class="material-icons">picture_as_pdf</i></a> <br>
                                                    </div>
                                                    <div class="col s6 m3"><strong>REINTIC:</strong></div>
                                                    <div class="col s6 m9">
                                                        <a href="./assets/documents/Cableado - REINTIC.webp"><i class="material-icons">photo_library</i></a> &nbsp; &nbsp;
                                                        <a href="./assets/documents/Cableado - REINTIC.pdf"><i class="material-icons">picture_as_pdf</i></a>
                                                    </div>
                                                </div>
                                                <u>Código de colores</u>
                                                <div>
                                                    <div class="row" style="border-bottom: 1px solid antiquewhite; margin-bottom: 0;">
                                                        <div class="col s2">
                                                            <i class="material-icons" style="color: lightseagreen; margin-top: 4px;">brightness_1</i>
                                                        </div>
                                                        <div class="col s10">
                                                            Sistema encendido
                                                        </div>
                                                    </div>
                                                    <div class="row" style="border-bottom: 1px solid antiquewhite; margin-bottom: 0;">
                                                        <div class="col s2">
                                                            <i class="material-icons" style="color: lightgrey; margin-top: 4px;">brightness_1</i>
                                                        </div>
                                                        <div class="col s10">
                                                            Sistema apagado
                                                        </div>
                                                    </div>
                                                    <div class="row" style="border-bottom: 1px solid antiquewhite; margin-bottom: 0;">
                                                        <div class="col s2">
                                                            <i class="material-icons" style="color: grey; margin-top: 4px;">brightness_1</i>
                                                        </div>
                                                        <div class="col s10">
                                                            Comunicación inestable
                                                        </div>
                                                    </div>
                                                    <div class="row" style="border-bottom: 1px solid antiquewhite; margin-bottom: 0;">
                                                        <div class="col s2">
                                                            <i class="material-icons" style="color: palevioletred; margin-top: 4px;">brightness_1</i>
                                                        </div>
                                                        <div class="col s10">
                                                            ¡Alarma: falla de seguridad!
                                                        </div>
                                                    </div>
                                                    <div class="row" style="border-bottom: 1px solid antiquewhite; margin-bottom: 0;">
                                                        <div class="col s2">
                                                            <i class="material-icons" style="color: red; margin-top: 4px;">brightness_1</i>
                                                        </div>
                                                        <div class="col s10">
                                                            Falla eléctrica
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <hr>
                                            <h5><strong>PumpControl</strong></h5>
                                            <p>¿Desea reducir el riesgo de fallas, averías y hasta roturas irreversibles de sus sitemas de bombeo? ¿Emplea una misma bomba para más de un sistema de riego? PumpControl es un sistema de monitoreo y control en tiempo real avanzado y a la vez sencillo de usar desde su teléfono celular o computadora que le permite enlazarlo con los sistemas de riego que desee y le previene de futuros desastres ante mal funcionamiento de sus equipo.</p>
                                            <hr>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>                                
                        <br>
                        <br>
                    </div>

                    <div id="systemConfigModal" class="modal">
                        <div class="modal-content">
                            <h6 style="text-align: center;">{{ systemConfigType.toUpperCase() }} </h6>
                            <div class="row">
                                <table class="striped highlight">
                                    <thead>
                                        <tr>
                                            <th>Temporizador (%)</th>
                                            <th>Agua (")</th>
                                            <th>Tiempo (h)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="conf in systemConfig | orderBy:'timer'" ng-click="setTimer(conf.timer)"
                                            class="modal-close">
                                            <td style="text-align: center;">{{ conf.timer }}</td>
                                            <td style="text-align: center;">{{ conf.wather }}</td>
                                            <td style="text-align: center;">{{ conf.degree }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <a href="#!" class="modal-close waves-effect waves-green btn-flat">Cancelar</a>
                        </div>
                    </div>

                </section>

                <!-- #endregion: AYUDA -->

                <!-- #region: USUARIOS -->

                <section id="usuarios">

                    <div class="container" style="margin-top: 50px;" ng-show="selectedWindow == 'login'">
                        <p class="sercices-options teal darken white-text">Acceder</p>
                        <br>
                        <div id="firebaseui-auth-container"></div>
                        <br>
                        <hr>
                        <br>
                        <div class="center">
                            <button ng-click="logout()" class="firebaseui-idp-button mdl-button mdl-js-button 
                            mdl-button--raised firebaseui-idp-google firebaseui-id-idp-button">
                            <i class="material-icons">exit_to_app</i> Salir
                        </button>
                        </div>
                    </div>

                    <div class="row" style="margin-top: 50px;" ng-show="selectedWindow == 'users'">
                        <div class="col s12" ng-init="more1 = true" style="margin-bottom: 20px;" ng-show="authUser">
                            <div style="background-color: rgba(255,255,255,0.9); box-shadow: 4px 4px 4px grey;">
                                <div class="btn" ng-click="more1 = !more1" style="width: 100%;">
                                    <span style="position: absolute; left: 20px;">
                                        <i class="material-icons">perm_identity</i>
                                    </span>
                                    <span>
                                        Perfil de usuario
                                    </span>
                                    <span style="position: absolute;right: 20px;">
                                        <i class="fa fa-chevron-down" aria-hidden="true" ng-show="!more1"></i>
                                        <i class="fa fa-chevron-up" aria-hidden="true" ng-show="more1"></i>
                                    </span>
                                </div>
                                <div ng-show="more1">
                                    <div class="container">
                                        <div class="row">
                                            <h6>Datos personales</h6>
                                            <div class="row">
                                                <div class="col s12 m3" ng-show="!authUser" style="text-align: center;">
                                                    <a href="#!login" ng-click="showWindow('login')"
                                                        style="color: black; width: 100px; height: 100px;">
                                                        <i class="fa fa-user" aria-hidden="true" style="margin-top: 5px;"></i>
                                                        <p style="margin-top: -5px;">Acceso</p>
                                                    </a>
                                                </div>
                                                <div class="col s12 m3" ng-show="authUser" style="text-align: center;">
                                                    <img id="imgAuthMobil" src="{{authUser.photoURL}}" class="img-auth"
                                                        style="width: 100px; height: 100px; border-radius: 50%; margin-top: 2px;"
                                                        ng-show="authUser.photoURL">
                                                    <i class="fa fa-user" aria-hidden="true"
                                                        style="margin-top: 5px; margin-bottom: 4px;"
                                                        ng-show="!authUser.photoURL"></i>
                                                    <!-- <p style="margin-top: -7px; color: black;">{{ authUser.displayName.split(" ")[0] }}</p> -->
                                                </div>
                                                <div class="form-group col s12 m9">
                                                    <label for="inputName">Nombre completo</label>
                                                    <input type="text" class=" form-control form-control-sm" id="inputName"
                                                        ng-model="authUser.displayName" placeholder="Nombre y Apellidos"
                                                        readonly>
                                                </div>
                                                <div class="form-group col s12 m9">
                                                    <label for="inputEmail">Correo electrónico</label>
                                                    <input type="email" class=" form-control form-control-sm" id="inputEmail"
                                                        ng-model="authUser.email" placeholder="Email" readonly>
                                                </div>
                                            </div>
                                            <h6>Ubicación</h6>
                                            <div class="row">
                                                <div class="form-group col s12">
                                                    <label for="inputAddress">Dirección</label>
                                                    <input type="text" class=" form-control form-control-sm" id="inputAddress"
                                                        placeholder="Calle y número" ng-model="userProfile.direccion">
                                                </div>
                                                <div class="form-group col s12">
                                                    <label for="inputLocation">Localidad</label>
                                                    <input type="text" class=" form-control form-control-sm" id="inputLocation"
                                                        placeholder="Estado, localidad" ng-model="userProfile.estado">
                                                </div>
                                                <div class="form-group col s12">
                                                    <label for="inputZip">Código postal</label>
                                                    <input type="text" class="form-control form-control-sm" id="inputZip"
                                                        placeholder="Código ZIP" ng-model="userProfile.zipCode">
                                                </div>
                                            </div>
                                            <h6>Datos de pago</h6>
                                            <div class="row">
                                                <div class="form-group col x12">
                                                    <label for="inputCBancaria">No tarjeta</label>
                                                    <input type="text" class=" form-control form-control-sm" id="inputCBancaria"
                                                        placeholder="XXXX-XXXX-XXXX-XXXX" ng-model="userProfile.bankAccount">
                                                </div>
                                            </div>
                                        </div>
                                        <p id="profileErrorMessage" style="display: none; clear: both; color: red;">Por favor,
                                            complete
                                            todos los campos correctamente!</p>
                                        <p id="profileToS" style="clear: both;">Al continuar con el contrato, estaría aceptando
                                            nuestros <a href="tos.html" target="blank">términos y condiciones</a></p>
                                        <div class="modal-footer right-align">
                                            <!-- <button type="button" class="waves-effect waves-light btn-small"
                                                ng-click="showWindow('services')">Cancelar</button> -->
                                            <button type="button" class="waves-effect waves-light btn-small red"
                                                ng-click="logout()">Cerrar
                                                sesión</button>
                                            <button type="button" class="waves-effect waves-light btn-small"
                                                ng-click="updateUserInfo()">Actualizar datos</button>
                                        </div>
                                        <br>
                                        <br>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col s12" ng-init="more2 = false" style="margin-bottom: 20px; display: none !important;"
                            ng-show="authUser">
                            <div class="btn" ng-click="more2 = !more2" style="width: 100%;">
                                <span style="position: absolute; left: 20px;">
                                    <i class="material-icons">people_outline</i>
                                </span>
                                <span>
                                    Usuarios por sistema
                                </span>
                                <span style="position: absolute;right: 20px;">
                                    <i class="fa fa-chevron-down" aria-hidden="true" ng-show="!more2"></i>
                                    <i class="fa fa-chevron-up" aria-hidden="true" ng-show="more2"></i>
                                </span>
                            </div>
                            <div ng-show="more2">
                                <div class="container">
                                    <div class="row" ng-repeat="user in systemUsers">
                                        <div class="form-group col s2">
                                            <i class="material-icons">people_outline</i>
                                        </div>
                                        <div class="form-group col s10">
                                            <span class="limitar">user.name</span>
                                            <span>user.role</span>
                                        </div>
                                    </div>
                                    <br>
                                    <br>
                                </div>
                            </div>
                        </div>
                    </div>

                </section>

                <!-- #endregion: USUARIOS -->

            </div>
        </div>

        <!-- #region: CSS Y SCRIPTS -->

        <link rel="stylesheet" href="./assets/modules/font-awesome/css/font-awesome.min.css">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link rel="stylesheet" href="./assets/modules/materialize/css/materialize.min.css">
        <link rel="stylesheet" href="./assets/modules/leaflet/leaflet.css">
        <link rel="stylesheet" href="./assets/css/style.css">
        <link rel="stylesheet" href="./assets/css/responsive.css">
        <!-- <link rel="stylesheet" href="./assets/css/meteocons-font/FONT/Font-face/stylesheet.css"> -->

        <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/4.0.0/firebaseui.css" />

        <script src="https://www.gstatic.com/firebasejs/5.10.1/firebase.js"></script>
        <script src="https://www.gstatic.com/firebasejs/ui/4.0.0/firebase-ui-auth__es_419.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-analytics.js"></script>
        <script src="./assets/js/firebaseComm.js"></script>
        <script src="./assets/js/notifications.js"></script>
        <!-- <script src="./assets/modules/angularjs/angular.min.js"></script> -->
        <script src="./assets/js/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-route.js"></script>
        <script src="./assets/modules/materialize/js/materialize.min.js"></script>
        <script src="./assets/modules/leaflet/leaflet.js"></script>
        <script src="./assets/modules/leaflet-semicircle/semicircle.js"></script>
        <script src="./assets/js/commons.js"></script>
        <!-- <script src="./assets/cultures/listPlanesRiego.js"></script> -->
        <script src="./assets/js/core.js"></script>
        <!-- <script src="monitor/js/chartjs/chart.min.js"></script> -->
        <script type="text/javascript" src="./assets/modules/datepicker/daterangepicker.js"></script>
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

        <!-- #endregion: CSS Y SCRIPTS -->

    </div>

    <ng-view></ng-view>

</body>

</html>

